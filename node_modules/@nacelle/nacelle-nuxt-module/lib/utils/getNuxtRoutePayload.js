import readJsonFile from './readJsonFile'

const DELIMITER = '--'

// Find the static json file or files for this item given the item's type
// Return an object of { route, payload } for Nuxt Generate to consume
export default ({ item, staticDir, locale }) => {
  const { handle, type } = item
  const payload = {}

  const spaceJson = readJsonFile(`${staticDir}/space.json`)

  if (spaceJson) {
    payload.space = spaceJson
  }

  if (type === 'product') {
    const productJson = readJsonFile(
      `${staticDir}/products/${handle}${DELIMITER}${locale}/static.json`
    )

    if (productJson) {
      payload.productData = productJson
    }
  }

  if (type === 'page') {
    const pageJson = readJsonFile(
      `${staticDir}/pages/${handle}${DELIMITER}${locale}/static.json`
    )
    const collectionJson = readJsonFile(
      `${staticDir}/collections/${handle}${DELIMITER}${locale}/static.json`
    )

    if (pageJson) {
      payload.pageData = pageJson
    }

    if (collectionJson) {
      payload.collectionData = collectionJson
    }
  }

  if (type === 'article') {
    const articleJson = readJsonFile(
      `${staticDir}/articles/${item.blogHandle}/${handle}${DELIMITER}${locale}/static.json`
    )
    const collectionJson = readJsonFile(
      `${staticDir}/collections/${handle}${DELIMITER}${locale}/static.json`
    )

    if (articleJson) {
      payload.articleData = articleJson
    }

    if (collectionJson) {
      payload.collectionData = collectionJson
    }
  }

  if (type === 'collection') {
    const collectionJson = readJsonFile(
      `${staticDir}/collections/${handle}${DELIMITER}${locale}/static.json`
    )

    if (collectionJson) {
      payload.collectionData = collectionJson
    }
  }

  if (type === 'blog') {
    const blogJson = readJsonFile(
      `${staticDir}/blogs/${handle}${DELIMITER}${locale}/static.json`
    )

    if (blogJson) {
      payload.blogData = blogJson
    }
  }

  if (type === 'shop') {
    const pageJson = readJsonFile(
      `${staticDir}/pages/${handle}${DELIMITER}${locale}/static.json`
    )
    const collectionJson = readJsonFile(
      `${staticDir}/collections/${handle}${DELIMITER}${locale}/static.json`
    )

    if (pageJson) {
      payload.pageData = pageJson
    }

    if (collectionJson) {
      payload.collectionData = collectionJson
    }
  }

  return payload
}
