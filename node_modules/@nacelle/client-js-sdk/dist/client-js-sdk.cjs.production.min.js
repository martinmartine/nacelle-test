"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,n=(e=require("axios"))&&"object"==typeof e&&"default"in e?e.default:e;const t=function(){function e(){}return e.prototype.then=function(n,t){const o=new e,i=this.s;if(i){const e=1&i?n:t;if(e){try{r(o,1,e(this.v))}catch(e){r(o,2,e)}return o}return this}return this.o=function(e){try{const i=e.v;1&e.s?r(o,1,n?n(i):i):t?r(o,1,t(i)):r(o,2,i)}catch(e){r(o,2,e)}},o},e}();function r(e,n,o){if(!e.s){if(o instanceof t){if(!o.s)return void(o.o=r.bind(null,e,n));1&n&&(n=o.s),o=o.v}if(o&&o.then)return void o.then(r.bind(null,e,n),r.bind(null,e,2));e.s=n,e.v=o;const i=e.o;i&&i(e)}}function o(e){return e instanceof t&&1&e.s}const i="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function a(e,n){try{var t=e()}catch(e){return n(e)}return t&&t.then?t.then(void 0,n):t}"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var c=function(){function e(e){this.connector=e.connector,this.locale=e.locale||"en-us",this.currencyCode=e.currencyCode||"USD",this.afterSubscriptions=[],this.onDataError=null,e.onDataError&&(this.onDataError=e.onDataError),this.connector.updateDefaults({locale:this.locale})}var n=e.prototype;return n.update=function(e){e.connector&&(this.connector=e.connector),e.locale&&(this.locale=e.locale,this.connector.updateDefaults({locale:this.locale})),e.currencyCode&&(this.currencyCode=e.currencyCode),void 0!==e.onDataError&&(this.onDataError=e.onDataError)},n.product=function(e,n){try{var t=this;return Promise.resolve(a((function(){function r(){return t.applyAfter("product",o)}var o,i=n?Promise.resolve(n.product(e)).then((function(e){o=e})):Promise.resolve(t.connector.product(e)).then((function(e){o=e}));return i&&i.then?i.then(r):r()}),(function(n){if(t.onDataError)return t.onDataError({method:"product",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.products=function(e,n){try{var t=this;return Promise.resolve(a((function(){function r(){return t.applyAfter("products",o)}var o,i=n?Promise.resolve(n.products(e)).then((function(e){o=e})):Promise.resolve(t.connector.products(e)).then((function(e){o=e}));return i&&i.then?i.then(r):r()}),(function(n){if(t.onDataError)return t.onDataError({method:"products",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.collection=function(e,n){try{var t=this;return Promise.resolve(a((function(){function r(){return t.applyAfter("collection",o)}var o,i=n?Promise.resolve(n.collection(e)).then((function(e){o=e})):Promise.resolve(t.connector.collection(e)).then((function(e){o=e}));return i&&i.then?i.then(r):r()}),(function(n){if(t.onDataError)return t.onDataError({method:"collection",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.collectionPage=function(e,n){try{var t=this;return Promise.resolve(a((function(){function r(){return t.applyAfter("collectionPage",o)}var o,i=n?Promise.resolve(n.collectionPage(e)).then((function(e){o=e})):Promise.resolve(t.connector.collectionPage(e)).then((function(e){o=e}));return i&&i.then?i.then(r):r()}),(function(n){if(t.onDataError)return t.onDataError({method:"collectionPage",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.content=function(e,n){try{var t=this;return Promise.resolve(a((function(){function r(){return t.applyAfter("content",o)}var o,i=n?Promise.resolve(n.content(e)).then((function(e){o=e})):Promise.resolve(t.connector.content(e)).then((function(e){o=e}));return i&&i.then?i.then(r):r()}),(function(n){if(t.onDataError)return t.onDataError({method:"content",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.page=function(e,n){try{var t=this;return Promise.resolve(a((function(){function r(){return t.applyAfter("page",o)}var o,i=n?Promise.resolve(n.page(e)).then((function(e){o=e})):Promise.resolve(t.connector.page(e)).then((function(e){o=e}));return i&&i.then?i.then(r):r()}),(function(n){if(t.onDataError)return t.onDataError({method:"page",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.pages=function(e,n){try{var t=this;return Promise.resolve(a((function(){function r(){return t.applyAfter("pages",o)}var o,i=n?Promise.resolve(n.pages(e)).then((function(e){o=e})):Promise.resolve(t.connector.pages(e)).then((function(e){o=e}));return i&&i.then?i.then(r):r()}),(function(n){if(t.onDataError)return t.onDataError({method:"pages",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.article=function(e,n){try{var t=this;return Promise.resolve(a((function(){function r(){return t.applyAfter("article",o)}var o,i=n?Promise.resolve(n.article(e)).then((function(e){o=e})):Promise.resolve(t.connector.article(e)).then((function(e){o=e}));return i&&i.then?i.then(r):r()}),(function(n){if(t.onDataError)return t.onDataError({method:"article",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.articles=function(e,n){try{var t=this;return Promise.resolve(a((function(){function r(){return t.applyAfter("articles",o)}var o,i=n?Promise.resolve(n.articles(e)).then((function(e){o=e})):Promise.resolve(t.connector.articles(e)).then((function(e){o=e}));return i&&i.then?i.then(r):r()}),(function(n){if(t.onDataError)return t.onDataError({method:"articles",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.blog=function(e,n){try{var t=this;return Promise.resolve(a((function(){function r(){return t.applyAfter("blog",o)}var o,i=n?Promise.resolve(n.blog(e)).then((function(e){o=e})):Promise.resolve(t.connector.blog(e)).then((function(e){o=e}));return i&&i.then?i.then(r):r()}),(function(n){if(t.onDataError)return t.onDataError({method:"blog",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.blogPage=function(e,n){try{var t=this;return Promise.resolve(a((function(){function r(){return t.applyAfter("blogPage",o)}var o,i=n?Promise.resolve(n.blogPage(e)).then((function(e){o=e})):Promise.resolve(t.connector.blogPage(e)).then((function(e){o=e}));return i&&i.then?i.then(r):r()}),(function(n){if(t.onDataError)return t.onDataError({method:"blogPage",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.space=function(e){try{var n=this;return Promise.resolve(a((function(){function t(){return n.applyAfter("space",r)}var r,o=e?Promise.resolve(e.space()).then((function(e){r=e})):Promise.resolve(n.connector.space()).then((function(e){r=e}));return o&&o.then?o.then(t):t()}),(function(e){if(n.onDataError)return n.onDataError({method:"space",params:{},error:e});throw e})))}catch(e){return Promise.reject(e)}},n.allProducts=function(e,n){try{var t=this;return Promise.resolve(a((function(){function r(){return t.applyAfter("allProducts",o)}var o,i=n?Promise.resolve(n.allProducts(e)).then((function(e){o=e})):Promise.resolve(t.connector.allProducts(e)).then((function(e){o=e}));return i&&i.then?i.then(r):r()}),(function(n){if(t.onDataError)return t.onDataError({method:"allProducts",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.allCollections=function(e,n){try{var t=this;return Promise.resolve(a((function(){function r(){return t.applyAfter("allCollections",o)}var o,i=n?Promise.resolve(n.allCollections(e)).then((function(e){o=e})):Promise.resolve(t.connector.allCollections(e)).then((function(e){o=e}));return i&&i.then?i.then(r):r()}),(function(n){if(t.onDataError)return t.onDataError({method:"allCollections",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.allContent=function(e,n){try{var t=!1,r=this;return Promise.resolve(a((function(){function o(e){return t?e:r.applyAfter("allContent",i)}var i,a=n?Promise.resolve(n.allContent(e)).then((function(e){i=e})):(t=!0,r.connector.allContent(e));return a&&a.then?a.then(o):o(a)}),(function(n){if(r.onDataError)return r.onDataError({method:"allContent",params:e,error:n});throw n})))}catch(e){return Promise.reject(e)}},n.after=function(e,n){this.afterSubscriptions.push({method:e,callback:n})},n.applyAfter=function(e,n){try{var a=n,c=function(e,n,a){if("function"==typeof e[i]){var c,l,s,u=e[i]();if(function e(i){try{for(;!(c=u.next()).done;)if((i=n(c.value))&&i.then){if(!o(i))return void i.then(e,s||(s=r.bind(null,l=new t,2)));i=i.v}l?r(l,1,i):l=i}catch(e){r(l||(l=new t),2,e)}}(),u.return){var d=function(e){try{c.done||u.return()}catch(e){}return e};if(l&&l.then)return l.then(d,(function(e){throw d(e)}));d()}return l}if(!("length"in e))throw new TypeError("Object is not iterable");for(var h=[],f=0;f<e.length;f++)h.push(e[f]);return function(e,n,i){var a,c,l=-1;return function i(s){try{for(;++l<e.length;)if((s=n(l))&&s.then){if(!o(s))return void s.then(i,c||(c=r.bind(null,a=new t,2)));s=s.v}a?r(a,1,s):a=s}catch(e){r(a||(a=new t),2,e)}}(),a}(h,(function(e){return n(h[e])}))}(this.afterSubscriptions.filter((function(n){return n.method===e})),(function(e){return Promise.resolve(e.callback(a)).then((function(e){a=e}))}));return Promise.resolve(c&&c.then?c.then((function(){return a})):a)}catch(e){return Promise.reject(e)}},e}();function l(){return(l=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function s(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n}function u(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n.indexOf(t=i[r])>=0||(o[t]=e[t]);return o}var d,h=function(){function e(e){this.client=n.create(l({responseType:"json",headers:{"Content-Type":"application/json"},timeout:24e4,maxContentLength:524328890},e))}var t=e.prototype;return t.get=function(e){return this.client.get(e)},t.post=function(e,n){return this.client.post(e,n)},e}(),f=function(){function e(e){this.apiClient=e&&e.httpClient?e.httpClient:new h,this.locale=e&&e.locale?e.locale:"en-us"}var n=e.prototype;return n.updateDefaults=function(e){e&&e.locale&&(this.locale=e.locale)},n.product=function(e){try{throw new Error("The default NacelleConnector does not return a product")}catch(e){return Promise.reject(e)}},n.products=function(e){try{throw new Error("The default NacelleConnector does not return products")}catch(e){return Promise.reject(e)}},n.collection=function(e){try{throw new Error("The default NacelleConnector does not return a collection")}catch(e){return Promise.reject(e)}},n.collectionPage=function(e){try{throw new Error("The default NacelleConnector does not return a collection page")}catch(e){return Promise.reject(e)}},n.content=function(e){try{throw new Error("This NacelleConnector does not return a content item")}catch(e){return Promise.reject(e)}},n.page=function(e){try{throw new Error("This NacelleConnector does not return a page item")}catch(e){return Promise.reject(e)}},n.pages=function(e){try{throw new Error("This NacelleConnector does not return pages")}catch(e){return Promise.reject(e)}},n.blog=function(e){try{throw new Error("This NacelleConnector does not return a blog")}catch(e){return Promise.reject(e)}},n.article=function(e){try{throw new Error("This NacelleConnector does not return an article")}catch(e){return Promise.reject(e)}},n.articles=function(e){try{throw new Error("This NacelleConnector does not return an article")}catch(e){return Promise.reject(e)}},n.blogPage=function(e){try{throw new Error("This NacelleConnector does not return a blog page")}catch(e){return Promise.reject(e)}},n.space=function(){try{throw new Error("This NacelleConnector does not return a space")}catch(e){return Promise.reject(e)}},n.allProducts=function(e){try{throw new Error("This NacelleConnector does not return all products")}catch(e){return Promise.reject(e)}},n.allCollections=function(e){try{throw new Error("This NacelleConnector does not return all collections")}catch(e){return Promise.reject(e)}},n.allContent=function(e){try{throw new Error("This NacelleConnector does not return all content")}catch(e){return Promise.reject(e)}},e}(),p=function(e,n){void 0===n&&(n={});var t=n.paginate,r=n.index,o=void 0===r?0:r,i=n.itemsPerPage,a=void 0===i?30:i,c=function(e,n){void 0===e&&(e="default");var t=n.find((function(n){return n.slug===e}));if(void 0!==t)return t;throw new Error("No default product list found")}(n.selectedList,e);if(c&&c.handles)return t?c.handles.slice(o,o+a):c.handles;throw new Error("Selected list does not have array of handles")},m=function(e){return l({id:"",handle:"",locale:"en-us",globalHandle:"",pimSyncSourceDomain:"",title:"",description:"",priceRange:{min:"0.0",max:"0.0",currencyCode:"USD"},availableForSale:!0,tags:[],media:[],metafields:[],variants:[],indexedAt:0},e)},v=function(e){return l({id:"",type:"image",src:"",thumbnailSrc:"",altText:""},e)},y=function(e){return l({title:"",slug:"default",locale:"en-us",handles:[]},e)},g=function(e){var n=e.productLists,t=e.featuredMedia,r=l({id:"",handle:"",locale:"en-us",globalHandle:"",pimSyncSourceDomain:"",productLists:[],featuredMedia:null},u(e,["productLists","featuredMedia"]),{metafields:e.metafields||[]});return n&&Array.isArray(n)&&(r.productLists=n.map((function(e){return y(e)}))),t&&(r.featuredMedia=v(t)),r},P=function(e){var n=e.articleLists,t=e.featuredMedia,r=e.sections,o=l({id:"",handle:"",locale:"",globalHandle:"",cmsSyncSource:"",cmsSyncSourceDomain:"",cmsSyncSourceContentId:"",type:"content",indexedAt:0,articleLists:null,featuredMedia:null,relatedArticles:[]},u(e,["articleLists","featuredMedia","sections"]));return r&&(o.sections=function(e,n){var t="string"==typeof e?JSON.parse(e):e;return Array.isArray(t)?t.map((function(e){if(e.tags){var t=(r=e.tags,Array.isArray(r)?l({},r.reduce((function(e,n){if(n.includes("field::")){var t=n.split("::");e[t[1]]=t[2]}return e}),{})):{});return l({},e,t,{cmsSyncSource:n})}var r;return l({},e,{cmsSyncSource:n})})):[]}(r,o.cmsSyncSource)),n&&Array.isArray(n)&&(o.articleLists=n.map((function(e){return y(e)}))),t&&(o.featuredMedia=v(t)),o},w=function(e){var n=e.linklists,t=e.metafields;return{id:e.id||"",name:e.name||"",domain:e.domain||"",linklists:Array.isArray(n)?n:[],metafields:Array.isArray(t)?t:[]}},b=function(e){function n(n){var t;if(t=e.call(this,n)||this,null==n.endpoint||""===n.endpoint)throw new Error("NacelleGraphQLConnector requires a valid endpoint.");if(null==n.spaceId||""===n.spaceId)throw new Error("NacelleGraphQLConnector requires a valid Nacelle space id.");if(null==n.token||""===n.token)throw new Error("NacelleGraphQLConnector requires a valid Nacelle space API token.");return t.endpoint=n.endpoint,t.spaceId=n.spaceId,t.token=n.token,t.apiClient=n&&n.httpClient?n.httpClient:new h({headers:{"Content-Type":"application/json","x-nacelle-space-id":t.spaceId,"x-nacelle-space-token":t.token}}),t}s(n,e);var i=n.prototype;return i.request=function(e,n,t){try{var r=this;return Promise.resolve(a((function(){return Promise.resolve(r.apiClient.post(r.endpoint,{query:e,variables:t})).then((function(e){if(e){if(e.data&&Array.isArray(e.data.errors)&&e.data.errors.length>0){var t=e.data.errors.pop();if(t&&t.message)throw new Error(t.message);throw new Error("Unknown graphql error attempting "+n)}if(e.data.data&&void 0!==e.data.data[n])return{success:!0,data:e.data.data[n]};throw new Error("Response did not include "+n+".\n            "+JSON.stringify(e.data,null,2))}throw new Error("No valid response from "+n)}))}),(function(e){return{success:!1,error:e.message,data:null}})))}catch(e){return Promise.reject(e)}},i.getAllPageItems=function(e){try{var n=function(){return c.reduce((function(e,n){return n&&n.items&&n.items.length>0?e.concat(n.items):e}),[])},i=this,a="",c=[],l=function(e,n){var i;do{var a=e();if(a&&a.then){if(!o(a)){i=!0;break}a=a.v}var c=n();if(o(c)&&(c=c.v),!c)return a}while(!c.then);const l=new t,s=r.bind(null,l,2);return(i?a.then(u):c.then(d)).then(void 0,s),l;function u(t){for(a=t;o(c=n())&&(c=c.v),c;){if(c.then)return void c.then(d).then(void 0,s);if((a=e())&&a.then){if(!o(a))return void a.then(u).then(void 0,s);a=a.v}}r(l,1,a)}function d(t){if(t){do{if((a=e())&&a.then){if(!o(a))return void a.then(u).then(void 0,s);a=a.v}if(o(t=n())&&(t=t.v),!t)return void r(l,1,a)}while(!t.then);t.then(d).then(void 0,s)}else r(l,1,a)}}((function(){return Promise.resolve(i.request(e.query,e.queryName,{first:e.first||500,after:a})).then((function(e){if(e.success&&e.data){var n=e.data;c.push(n),a=n.nextToken}else a=""}))}),(function(){return""!==a}));return Promise.resolve(l&&l.then?l.then(n):n())}catch(e){return Promise.reject(e)}},i.product=function(e){try{return Promise.resolve(this.request("\nquery getProductByHandle($handle: String!, $locale: String) {\n  getProductByHandle(handle: $handle, locale: $locale) {\n    \n  id\n  handle\n  locale\n  globalHandle\n  pimSyncSource\n  pimSyncSourceDomain\n  pimSyncSourceProductId\n  title\n  description\n  priceRange {\n    min\n    max\n    currencyCode\n  }\n  productType\n  media {\n    \n  id\n  thumbnailSrc\n  src\n  type\n  altText\n\n  }\n  featuredMedia {\n    \n  id\n  thumbnailSrc\n  src\n  type\n  altText\n\n  }\n  availableForSale\n  vendor\n  tags\n  createdAt\n  metafields {\n    \n  id\n  namespace\n  key\n  value\n\n  }\n  indexedAt\n  variants {\n    id\n    title\n    price\n    priceCurrency\n    compareAtPrice\n    compareAtPriceCurrency\n    swatchSrc\n    selectedOptions {\n      name\n      value\n    }\n    featuredMedia {\n      \n  id\n  thumbnailSrc\n  src\n  type\n  altText\n\n    }\n    sku\n    availableForSale\n    metafields {\n      \n  id\n  namespace\n  key\n  value\n\n    }\n    weight\n    weightUnit\n    priceRules {\n      id\n      handle\n      title\n      price\n      priceCurrency\n      comparedAtPrice\n       metafields {\n          \n  id\n  namespace\n  key\n  value\n\n        }\n      priceBreaks {\n        quantityMin\n        quantityMax\n        price\n        metafields {\n          \n  id\n  namespace\n  key\n  value\n\n        }\n      }\n      availableTo\n    }\n  }\n\n  }\n}\n","getProductByHandle",{handle:e.handle,locale:e.locale||"en-us"})).then((function(e){if(e.success&&e.data)return m(e.data);throw new Error(e.error)}))}catch(e){return Promise.reject(e)}},i.products=function(e){try{var n=this,t=e.locale||n.locale,r=e.handles.map((function(e){return n.product({handle:e,locale:t}).catch((function(){}))}));return Promise.resolve(Promise.all(r)).then((function(e){return e.reduce((function(e,n){return n&&e.push(n),e}),[])}))}catch(e){return Promise.reject(e)}},i.collection=function(e){try{return Promise.resolve(this.request("\nquery getCollectionByHandle($handle: String!, $locale: String) {\n  getCollectionByHandle(handle: $handle, locale: $locale) {\n    \n  id\n  handle\n  globalHandle\n  locale\n  pimSyncSourceDomain\n  pimSyncSource\n  pimSyncSourceCollectionId\n  title\n  description\n  metafields {\n    \n  id\n  namespace\n  key\n  value\n\n  }\n  featuredMedia {\n    \n  id\n  thumbnailSrc\n  src\n  type\n  altText\n\n  }\n  productLists {\n    title\n    slug\n    locale\n    handles\n  }\n\n  }\n}\n","getCollectionByHandle",{handle:e.handle,locale:e.locale||"en-us"})).then((function(e){if(e.success&&e.data)return g(e.data);throw new Error(e.error)}))}catch(e){return Promise.reject(e)}},i.collectionPage=function(e){try{var n=function(e){if(t)return e;var n=p(u.productLists,{selectedList:a,paginate:void 0!==c&&c,index:l,itemsPerPage:s});return r.products({handles:n,locale:i})},t=!1,r=this,o=e.handle,i=e.locale,a=e.list,c=e.paginate,l=e.index,s=e.itemsPerPage,u=e.collection,d=function(){if(void 0===u)return function(){if(o&&o.length>0)return Promise.resolve(r.collection({handle:o,locale:i})).then((function(e){u=e}));throw new Error("A collection or handle is required")}()}();return Promise.resolve(d&&d.then?d.then(n):n(d))}catch(e){return Promise.reject(e)}},i.content=function(e){var n=e.handle,t=e.type,r=void 0===t?"page":t,o=e.locale,i=e.blogHandle,a=void 0===i?"blog":i;try{return Promise.resolve(this.request("\nquery getContentByHandle($type: String!, $handle: String!, $locale: String, $blogHandle: String) {\n  getContentByHandle(type: $type, handle: $handle, locale: $locale, blogHandle: $blogHandle) {\n    id\n    handle\n    locale\n    globalHandle\n    cmsSyncSource\n    cmsSyncSourceDomain\n    cmsSyncSourceContentId\n    type\n    indexedAt\n    title\n    description\n    sections\n    tags\n    fields\n    articleLists {\n      title\n      slug\n      locale\n      handles\n    }\n    relatedArticles {\n      handle\n      title\n      blogHandle\n      cmsSyncSourceContentId\n      locale\n      createdAt\n      updatedAt\n      author {\n        firstName\n        lastName\n        bio\n        email\n      }\n      featuredMedia {\n        id\n        type\n        src\n        thumbnailSrc\n        altText\n      }\n      publishDate\n      description\n      excerpt\n      tags\n    }\n    collectionHandle\n    content\n    contentHtml\n    excerpt\n    blogHandle\n    featuredMedia {\n      id\n      type\n      src\n      thumbnailSrc\n      altText\n    }\n    publishDate\n    author {\n      firstName\n      lastName\n      bio\n      email\n    }\n    createdAt\n    updatedAt\n  }\n}","getContentByHandle",{type:r,handle:n,locale:o||this.locale,blogHandle:a})).then((function(e){if(e.success&&e.data)return P(e.data);throw new Error(e.error)}))}catch(e){return Promise.reject(e)}},i.page=function(e){return this.content({handle:e.handle,type:"page",locale:e.locale})},i.pages=function(e){try{var n=this,t=e.locale||n.locale,r=e.handles.map((function(e){return n.content({type:"page",handle:e,locale:t}).catch((function(){}))}));return Promise.resolve(Promise.all(r)).then((function(e){return e.reduce((function(e,n){return n&&e.push(n),e}),[])}))}catch(e){return Promise.reject(e)}},i.blog=function(e){return this.content({handle:e.handle,type:"blog",locale:e.locale})},i.article=function(e){return this.content({handle:e.handle,type:"article",locale:e.locale,blogHandle:e.blogHandle||"blog"})},i.articles=function(e){try{var n=this,t=e.blogHandle,r=e.locale||n.locale,o=e.handles.map((function(e){return n.article({handle:e,blogHandle:t,locale:r}).catch((function(){}))}));return Promise.resolve(Promise.all(o)).then((function(e){return e.reduce((function(e,n){return n&&e.push(n),e}),[])}))}catch(e){return Promise.reject(e)}},i.blogPage=function(e){try{var n=function(e){if(t)return e;if(u.articleLists){var n=p(u.articleLists,{selectedList:a,paginate:void 0!==c&&c,index:l,itemsPerPage:s});return r.articles({handles:n,locale:i,blogHandle:o||u.handle})}return[]},t=!1,r=this,o=e.handle,i=e.locale,a=e.list,c=e.paginate,l=e.index,s=e.itemsPerPage,u=e.blog,d=function(){if(void 0===u)return function(){if(o&&o.length>0)return Promise.resolve(r.blog({handle:o,locale:i})).then((function(e){u=e}));throw new Error("A blog or handle is required")}()}();return Promise.resolve(d&&d.then?d.then(n):n(d))}catch(e){return Promise.reject(e)}},i.allProducts=function(e){try{return Promise.resolve(this.getAllPageItems({query:"\nquery getProducts($first: Int, $after: String) {\n  getProducts(first: $first, after: $after) {\n    items {\n      \n  id\n  handle\n  locale\n  globalHandle\n  pimSyncSource\n  pimSyncSourceDomain\n  pimSyncSourceProductId\n  title\n  description\n  priceRange {\n    min\n    max\n    currencyCode\n  }\n  productType\n  media {\n    \n  id\n  thumbnailSrc\n  src\n  type\n  altText\n\n  }\n  featuredMedia {\n    \n  id\n  thumbnailSrc\n  src\n  type\n  altText\n\n  }\n  availableForSale\n  vendor\n  tags\n  createdAt\n  metafields {\n    \n  id\n  namespace\n  key\n  value\n\n  }\n  indexedAt\n  variants {\n    id\n    title\n    price\n    priceCurrency\n    compareAtPrice\n    compareAtPriceCurrency\n    swatchSrc\n    selectedOptions {\n      name\n      value\n    }\n    featuredMedia {\n      \n  id\n  thumbnailSrc\n  src\n  type\n  altText\n\n    }\n    sku\n    availableForSale\n    metafields {\n      \n  id\n  namespace\n  key\n  value\n\n    }\n    weight\n    weightUnit\n    priceRules {\n      id\n      handle\n      title\n      price\n      priceCurrency\n      comparedAtPrice\n       metafields {\n          \n  id\n  namespace\n  key\n  value\n\n        }\n      priceBreaks {\n        quantityMin\n        quantityMax\n        price\n        metafields {\n          \n  id\n  namespace\n  key\n  value\n\n        }\n      }\n      availableTo\n    }\n  }\n\n    }\n    nextToken\n  }\n}\n",queryName:"getProducts",first:e&&e.limit?e.limit:2e3})).then((function(e){return e.map((function(e){return m(e)}))}))}catch(e){return Promise.reject(e)}},i.allCollections=function(e){try{return Promise.resolve(this.getAllPageItems({query:"\nquery getCollections($first: Int, $after: String) {\n  getCollections(first: $first, after: $after) {\n    nextToken\n    items {\n      \n  id\n  handle\n  globalHandle\n  locale\n  pimSyncSourceDomain\n  pimSyncSource\n  pimSyncSourceCollectionId\n  title\n  description\n  metafields {\n    \n  id\n  namespace\n  key\n  value\n\n  }\n  featuredMedia {\n    \n  id\n  thumbnailSrc\n  src\n  type\n  altText\n\n  }\n  productLists {\n    title\n    slug\n    locale\n    handles\n  }\n\n    }\n  }\n}\n",queryName:"getCollections",first:e&&e.limit?e.limit:2e3})).then((function(e){return e.map((function(e){return g(e)}))}))}catch(e){return Promise.reject(e)}},i.allContent=function(e){try{return Promise.resolve(this.getAllPageItems({query:"\nquery getContent($first: Int, $after: String) {\n  getContent(first: $first, after: $after) {\n    nextToken\n    items {\n      id\n      handle\n      locale\n      globalHandle\n      cmsSyncSource\n      cmsSyncSourceDomain\n      cmsSyncSourceContentId\n      type\n      indexedAt\n      title\n      description\n      sections\n      tags\n      fields\n      articleLists {\n        title\n        slug\n        locale\n        handles\n      }\n      relatedArticles {\n        handle\n        title\n        blogHandle\n        cmsSyncSourceContentId\n        locale\n        createdAt\n        updatedAt\n        author {\n          firstName\n          lastName\n          bio\n          email\n        }\n        featuredMedia {\n          \n  id\n  thumbnailSrc\n  src\n  type\n  altText\n\n        }\n        publishDate\n        description\n        excerpt\n        tags\n      }\n      collectionHandle\n      content\n      contentHtml\n      excerpt\n      blogHandle\n      featuredMedia {\n        \n  id\n  thumbnailSrc\n  src\n  type\n  altText\n\n      }\n      publishDate\n      author {\n        firstName\n        lastName\n        bio\n        email\n      }\n      createdAt\n      updatedAt\n    }\n  }\n}",queryName:"getContent",first:e&&e.limit?e.limit:2e3})).then((function(e){return e.map((function(e){return P(e)}))}))}catch(e){return Promise.reject(e)}},i.space=function(){try{return Promise.resolve(this.request("\nquery GetSpace {\n  getSpace {\n    id\n    name\n    domain\n    metafields {\n      namespace\n      key\n      value\n    }\n    linklists {\n      handle\n      links {\n        title\n        to\n        type\n        links {\n          title\n          to\n          type\n          links {\n            title\n            to\n            type\n          }\n        }\n      }\n    }\n  }\n}","getSpace")).then((function(e){if(e){if(e.success&&e.data)return w(e.data);if(e&&!e.success&&e.error)throw new Error(e.error)}throw new Error("Invalid response attempting getSpace query")}))}catch(e){return Promise.reject(e)}},i.processCheckout=function(e){try{return Promise.resolve(this.request("\nmutation processCheckout($input: CheckoutInput) {\n  processCheckout(input: $input) {\n    id\n    url\n    completed\n  }\n}\n","processCheckout",{input:l({},e)})).then((function(e){if(e){if(e.success&&e.data)return e.data;if(e&&!e.success&&e.error)throw new Error(e.error)}throw new Error("Invalid response attempting processCheckout mutation")}))}catch(e){return Promise.reject(e)}},i.queryCheckout=function(e){try{return Promise.resolve(this.request("\nquery getCheckout($id: ID!, $url: String!) {\n  getCheckout(id: $id, url: $url) {\n    id\n    url\n    completed\n  }\n}\n","getCheckout",l({},e))).then((function(e){if(e){if(e.success&&e.data)return e.data;if(e&&!e.success&&e.error)throw new Error(e.error)}throw new Error("Invalid response attempting getCheckout query")}))}catch(e){return Promise.reject(e)}},i.isVariantAvailable=function(e){try{return Promise.resolve(this.request("\nquery GetVariantAvailability($productId: String!, $variantId: String!) {\n  getVariantAvailability(productId: $productId, variantId: $variantId)\n}\n","getVariantAvailability",l({},e))).then((function(e){if(e){if(e.success&&null!=e.data)return e.data;if(e&&!e.success&&e.error)throw new Error(e.error)}throw new Error("Invalid response attempting getVariantAvailability query")}))}catch(e){return Promise.reject(e)}},n}(f),E=function(){function e(e){if(e.connector)this.connector=e.connector;else{if(!(e.endpoint&&e.spaceId&&e.token))throw new Error("Missing parameters to initialize checkout module");this.connector=new b({endpoint:e.endpoint,spaceId:e.spaceId,token:e.token})}}var n=e.prototype;return n.process=function(e){return this.connector.processCheckout(e)},n.get=function(e){if(void 0===e.id||0===e.id.length)throw new Error('Missing parameter "id". Querying for a checkout requires a checkout Id.');if(void 0===e.url||0===e.url.length)throw new Error('Missing parameter "url". Querying for a checkout requires a checkout url.');return this.connector.queryCheckout(e)},e}(),S=function(){function e(e){if(e.connector)this.connector=e.connector;else{if(!(e.endpoint&&e.spaceId&&e.token))throw new Error("Missing parameters to initialize checkout module");this.connector=new b({endpoint:e.endpoint,spaceId:e.spaceId,token:e.token})}}return e.prototype.isVariantAvailable=function(e){return this.connector.isVariantAvailable(e)},e}(),C=function(){function e(e){this.endpoint=e&&e.endpoint&&e.endpoint.length>0?e.endpoint:process&&process.env&&process.env.NACELLE_WISHLIST_ENDPOINT&&process.env.NACELLE_WISHLIST_ENDPOINT.length>0?process.env.NACELLE_WISHLIST_ENDPOINT:"https://wishlist.hailfrequency.com/graphql",this.apiClient=e&&e.httpClient?e.httpClient:new h({headers:{"Content-Type":"application/json","X-Nacelle-Space-Id":e.spaceId,"X-Nacelle-Space-Token":e.token}})}var n=e.prototype;return n.put=function(e){return this.apiClient.post(this.endpoint,{query:"\n  mutation putWishlist ($input: WishlistInput!) {\n    putWishlist (input: $input) {\n      id,\n      customerSourceId,\n      items {\n        variantId\n        handle\n      }\n    }\n  }\n",variables:{input:l({},e)}})},n.get=function(e){return this.apiClient.post(this.endpoint,{query:"\n  query getWishlistsByCustomerSourceId ($customerId: String!, $first: Int, $nextToken: String) {\n    getWishlistsByCustomerSourceId (customerId: $customerId, first: $first, nextToken: $nextToken) {\n      items {\n        id,\n        customerSourceId,\n        title\n        \n        items {\n          variantId\n          handle\n        }\n      }\n      nextToken\n    }\n  }\n",variables:e})},e}();!function(e){e.productView="productView",e.search="search",e.productRecommendation="productRecommendation",e.pageView="pageView",e.collectionView="collectionView",e.blogView="blogView",e.articleView="articleView",e.cartAdd="cartAdd",e.cartRemove="cartRemove",e.checkoutInit="checkoutInit",e.checkoutComplete="checkoutComplete"}(d||(d={}));var k=function(){function e(e){this.endpoint=e&&e.endpoint&&e.endpoint.length>0?e.endpoint:process&&process.env&&process.env.NACELLE_TEM_ENDPOINT&&process.env.NACELLE_TEM_ENDPOINT.length>0?process.env.NACELLE_TEM_ENDPOINT:"https://tem.hailfrequency.com/events/add",this.apiClient=e&&e.httpClient?e.httpClient:new h,this.disable=!(!e||void 0===e.disable)&&e.disable,this.subscriptions=[],this.attributionEvents={}}var n=e.prototype;return n.log=function(e){if(!this.disable){q();var n=l({},e,{user:l({device:A()},e.user)},j(e.url),D()),t=this.attributionEvents[n.eventType];t&&T({attributionType:n.eventType,attributionData:t(n)});var r=this.subscriptions.filter((function(e){var t=e.eventType;return n.eventType===t||"*"===t})).filter((function(e){return!!e.callback})).map((function(e){return(0,e.callback)(n)})).reduce((function(e,n){return l({},e,n)}),{}),o=l({},n,r);this.apiClient.post(this.endpoint,o)}},n.onAttributionEvent=function(e,n){this.attributionEvents[e]=n},n.onEvent=function(e,n){this.subscriptions.push({eventType:e,callback:n})},e}(),A=function(){var e=I();return e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent.toLowerCase():"unknown"},j=function(e){var n=I(),t=n&&n.location&&n.location.href,r=x((function(){return new URL(e||"")}),(function(){return x((function(){return new URL(t||"")}),(function(){}))})),o=r?r.search.replace(/^\?/g,"").split("&").filter((function(e){return!!e&&e.length})):[];return{url:r?r.toString():"",domain:r?r.hostname:"",route:r?r.pathname:"",urlParams:o}},I=function(){return x((function(){return globalThis}),(function(){return x((function(){return window}),(function(){return x((function(){return global}),(function(){}))}))}))},D=function(){var e=I();return e&&e.nacelleEventData||{}},T=function(e){var n=I();n&&(n.nacelleEventData=l({},n.nacelleEventData,e))},q=function(){var e=D();T({sessionEventCount:(e.sessionEventCount||0)+1})},x=function(e,n){try{return e()}catch(e){return n(e)}},N=["product","collection","page","blog","article","content"],L=function(e){var n=e.locale.toLowerCase().replace("_","-"),t=e.handle+"--"+n;return-1===N.indexOf(e.type)&&(t=t+"--"+e.type),""+function(e,n){switch(null==n?n="":n+="/",e){case"collection":return"data/collections/"+n;case"page":return"data/pages/"+n;case"product":return"data/products/"+n;case"shop":return"data/shop/"+n;case"article":return"data/articles/"+n;case"blog":return"data/blogs/"+n;default:return"data/content/"+n}}(e.type,e.parentHandle)+t+"/static.json"},H=function(e){function n(n){var t;return(t=e.call(this,n)||this).basePath=n&&n.basePath?n.basePath:"/",t}s(n,e);var t=n.prototype;return t.request=function(e){try{var n=this,t=""+n.basePath+e;return Promise.resolve(a((function(){return Promise.resolve(n.apiClient.get(t)).then((function(e){if(e&&e.data&&e.headers&&e.headers["content-type"].includes("application/json"))return{success:!0,data:e.data};throw new Error("Unable to find static resource at "+t)}))}),(function(e){return{success:!1,error:e.message,data:null}})))}catch(e){return Promise.reject(e)}},t.requestMany=function(e){try{var n=this,t=e.map((function(e){return n.request(e)}));return Promise.resolve(Promise.all(t)).then((function(e){return e.reduce((function(e,n){return n.success&&n.data&&e.push(n.data),e}),[])}))}catch(e){return Promise.reject(e)}},t.product=function(e){try{var n=this;return Promise.resolve(a((function(){var t=L({type:"product",handle:e.handle,locale:e.locale||n.locale});return Promise.resolve(n.request(t)).then((function(e){if(e.success&&e.data)return m(e.data);throw new Error(e.error)}))}),(function(t){if(n.onError)return n.onError({method:"product",params:e,error:t});throw t})))}catch(e){return Promise.reject(e)}},t.products=function(e){try{var n=this,t=e.locale||n.locale,r=e.handles.map((function(e){return n.product({handle:e,locale:t}).catch((function(){}))}));return Promise.resolve(Promise.all(r)).then((function(e){return e.reduce((function(e,n){return n&&e.push(n),e}),[])}))}catch(e){return Promise.reject(e)}},t.collection=function(e){try{var n=this;return Promise.resolve(a((function(){var t=L({type:"collection",handle:e.handle,locale:e.locale||n.locale});return Promise.resolve(n.request(t)).then((function(e){if(e.success&&e.data)return g(e.data);throw new Error(e.error)}))}),(function(t){if(n.onError)return n.onError({method:"collection",params:e,error:t});throw t})))}catch(e){return Promise.reject(e)}},t.collectionPage=function(e){try{var n=this;return Promise.resolve(a((function(){function t(e){var t=p(s.productLists,{selectedList:i,paginate:void 0!==a&&a,index:c,itemsPerPage:l});return n.products({handles:t,locale:o})}var r=e.handle,o=e.locale,i=e.list,a=e.paginate,c=e.index,l=e.itemsPerPage,s=e.collection,u=function(){if(void 0===s)return function(){if(r&&r.length>0)return Promise.resolve(n.collection({handle:r,locale:o})).then((function(e){s=e}));throw new Error("A collection or handle is required")}()}();return u&&u.then?u.then(t):t()}),(function(t){if(n.onError)return n.onError({method:"collectionPage",params:e,error:t});throw t})))}catch(e){return Promise.reject(e)}},t.content=function(e){var n=e.handle,t=e.type,r=void 0===t?"page":t,o=e.locale,i=e.blogHandle,c=void 0===i?"blog":i;try{var l=this;return Promise.resolve(a((function(){var e=o||l.locale,t=L({type:r,handle:n,locale:e});return"article"===r&&(t=L({type:r,handle:n,locale:e,parentHandle:c})),Promise.resolve(l.request(t)).then((function(e){if(e.success&&e.data)return P(e.data);throw new Error(e.error)}))}),(function(e){if(l.onError)return l.onError({method:"content",params:{handle:n,type:r,locale:o,blogHandle:c},error:e});throw e})))}catch(e){return Promise.reject(e)}},t.page=function(e){return this.content({handle:e.handle,type:"page",locale:e.locale})},t.pages=function(e){try{var n=this,t=e.locale||n.locale,r=e.handles.map((function(e){return n.content({type:"page",handle:e,locale:t}).catch((function(){}))}));return Promise.resolve(Promise.all(r)).then((function(e){return e.reduce((function(e,n){return n&&e.push(n),e}),[])}))}catch(e){return Promise.reject(e)}},t.blog=function(e){return this.content({handle:e.handle,type:"blog",locale:e.locale})},t.article=function(e){return this.content({handle:e.handle,type:"article",locale:e.locale,blogHandle:e.blogHandle||"blog"})},t.articles=function(e){try{var n=this,t=e.blogHandle,r=e.locale||n.locale,o=e.handles.map((function(e){return n.article({handle:e,blogHandle:t,locale:r}).catch((function(){}))}));return Promise.resolve(Promise.all(o)).then((function(e){return e.reduce((function(e,n){return n&&e.push(n),e}),[])}))}catch(e){return Promise.reject(e)}},t.blogPage=function(e){try{var n=this;return Promise.resolve(a((function(){function t(e){if(s.articleLists){var t=p(s.articleLists,{selectedList:i,paginate:void 0!==a&&a,index:c,itemsPerPage:l});return n.articles({handles:t,locale:o,blogHandle:r||s.handle})}return[]}var r=e.handle,o=e.locale,i=e.list,a=e.paginate,c=e.index,l=e.itemsPerPage,s=e.blog,u=function(){if(void 0===s)return function(){if(r&&r.length>0)return Promise.resolve(n.blog({handle:r,locale:o})).then((function(e){s=e}));throw new Error("A blog or handle is required")}()}();return u&&u.then?u.then(t):t()}),(function(t){if(n.onError)return n.onError({method:"blogPage",params:e,error:t});throw t})))}catch(e){return Promise.reject(e)}},t.space=function(){try{return Promise.resolve(this.request("data/space.json")).then((function(e){if(e.success&&e.data)return w(e.data);throw new Error(e.error)}))}catch(e){return Promise.reject(e)}},t.allProducts=function(){try{return Promise.resolve(this.request("data/search.json")).then((function(e){if(e.success&&e.data&&e.data.products)return e.data.products.map((function(e){return m(e)}));if(e.error)throw new Error(e.error);throw new Error("Unable to get all products from search.json static file.")}))}catch(e){return Promise.reject(e)}},n}(f);exports.HttpClientAxios=h,exports.NacelleConnector=f,exports.NacelleGraphQLConnector=b,exports.NacelleStaticConnector=H,exports.createCollection=g,exports.createContent=P,exports.createItemList=y,exports.createMedia=v,exports.createProduct=m,exports.default=function(e){if(void 0===e.token||0===e.token.length)throw new Error("Nacelle space token is required.");if(void 0===e.id||0===e.id.length)throw new Error("Nacelle space id is required.");if(void 0===e.nacelleEndpoint||0===e.nacelleEndpoint.length)throw new Error("Nacelle endpoint is required");this.id=e.id,this.token=e.token,this.nacelleEndpoint=e.nacelleEndpoint,this.useStatic=void 0===e.useStatic||e.useStatic,this.debugMode=void 0!==e.debugMode&&e.debugMode,this.defaultLocale=void 0!==e.locale?e.locale:"en-us",new f({locale:this.defaultLocale});var n=new H({basePath:e.staticBasePath,locale:this.defaultLocale}),t=new b({endpoint:this.nacelleEndpoint,spaceId:this.id,token:this.token,locale:this.defaultLocale});this.data=new c({connector:this.useStatic?n:t,locale:this.defaultLocale}),this.checkout=new E({connector:t}),this.status=new S({connector:t});var r={};e.eventsEndpoint&&(r.endpoint=e.eventsEndpoint),e.disableEvents&&(r.disable=e.disableEvents),this.events=new k(r);var o={spaceId:this.id,token:this.token};e.wishlistEndpoint&&(o.endpoint=e.wishlistEndpoint),this.wishlist=new C(o)};
//# sourceMappingURL=client-js-sdk.cjs.production.min.js.map
