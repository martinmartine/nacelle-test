{"version":3,"file":"client-js-sdk.cjs.development.js","sources":["../node_modules/babel-plugin-transform-async-to-promises/helpers.js","../src/modules/data.ts","../src/util/http/HttpClientAxios.ts","../src/connectors/nacelleConnector.ts","../src/connectors/static/utils/getList.ts","../src/connectors/static/utils/getListHandles.ts","../src/objects/product.ts","../src/objects/media.ts","../src/objects/itemList.ts","../src/objects/collection.ts","../src/util/createFieldsFromTags.ts","../src/objects/contentSection.ts","../src/objects/content.ts","../src/objects/space.ts","../src/connectors/graphql/fragments/mediaFragment.ts","../src/connectors/graphql/fragments/metafieldFragment.ts","../src/connectors/graphql/fragments/productFragment.ts","../src/connectors/graphql/queries/getProductsQuery.ts","../src/connectors/graphql/fragments/collectionFragment.ts","../src/connectors/graphql/queries/getCollectionsQuery.ts","../src/connectors/graphql/queries/getContentQuery.ts","../src/connectors/graphql/queries/getSpaceQuery.ts","../src/connectors/graphql/queries/getCheckoutQuery.ts","../src/connectors/graphql/queries/getVariantAvailabilityQuery.ts","../src/connectors/graphql/mutations/processCheckoutMutation.ts","../src/connectors/graphql/queries/getProductByHandleQuery.ts","../src/connectors/graphql/queries/getCollectionByHandleQuery.ts","../src/connectors/graphql/queries/getContentByHandleQuery.ts","../src/connectors/graphql/nacelleGraphQLConnector.ts","../src/modules/checkout.ts","../src/modules/status.ts","../src/connectors/graphql/queries/getWishlistsByCustomerSourceIdQuery.ts","../src/connectors/graphql/mutations/putWishlistMutation.ts","../src/modules/wishlist.ts","../src/modules/events.ts","../src/connectors/static/utils/constructDataPathPrefix.ts","../src/connectors/static/utils/constructDataPath.ts","../src/connectors/static/nacelleStaticConnector.ts","../src/nacelle-client/index.ts"],"sourcesContent":["// A type of promise-like that resolves synchronously and supports only one observer\nexport const _Pact = /*#__PURE__*/(function() {\n\tfunction _Pact() {}\n\t_Pact.prototype.then = function(onFulfilled, onRejected) {\n\t\tconst result = new _Pact();\n\t\tconst state = this.s;\n\t\tif (state) {\n\t\t\tconst callback = state & 1 ? onFulfilled : onRejected;\n\t\t\tif (callback) {\n\t\t\t\ttry {\n\t\t\t\t\t_settle(result, 1, callback(this.v));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t_settle(result, 2, e);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t\tthis.o = function(_this) {\n\t\t\ttry {\n\t\t\t\tconst value = _this.v;\n\t\t\t\tif (_this.s & 1) {\n\t\t\t\t\t_settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n\t\t\t\t} else if (onRejected) {\n\t\t\t\t\t_settle(result, 1, onRejected(value));\n\t\t\t\t} else {\n\t\t\t\t\t_settle(result, 2, value);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(result, 2, e);\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n\treturn _Pact;\n})();\n\n// Settles a pact synchronously\nexport function _settle(pact, state, value) {\n\tif (!pact.s) {\n\t\tif (value instanceof _Pact) {\n\t\t\tif (value.s) {\n\t\t\t\tif (state & 1) {\n\t\t\t\t\tstate = value.s;\n\t\t\t\t}\n\t\t\t\tvalue = value.v;\n\t\t\t} else {\n\t\t\t\tvalue.o = _settle.bind(null, pact, state);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (value && value.then) {\n\t\t\tvalue.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n\t\t\treturn;\n\t\t}\n\t\tpact.s = state;\n\t\tpact.v = value;\n\t\tconst observer = pact.o;\n\t\tif (observer) {\n\t\t\tobserver(pact);\n\t\t}\n\t}\n}\n\nexport function _isSettledPact(thenable) {\n\treturn thenable instanceof _Pact && thenable.s & 1;\n}\n\n// Converts argument to a function that always returns a Promise\nexport function _async(f) {\n\treturn function() {\n\t\tfor (var args = [], i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\t\ttry {\n\t\t\treturn Promise.resolve(f.apply(this, args));\n\t\t} catch(e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n}\n\n// Awaits on a value that may or may not be a Promise (equivalent to the await keyword in ES2015, with continuations passed explicitly)\nexport function _await(value, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(value) : value;\n\t}\n\tif (!value || !value.then) {\n\t\tvalue = Promise.resolve(value);\n\t}\n\treturn then ? value.then(then) : value;\n}\n\n// Awaits on a value that may or may not be a Promise, then ignores it\nexport function _awaitIgnored(value, direct) {\n\tif (!direct) {\n\t\treturn value && value.then ? value.then(_empty) : Promise.resolve();\n\t}\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continue(value, then) {\n\treturn value && value.then ? value.then(then) : then(value);\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continueIgnored(value) {\n\tif (value && value.then) {\n\t\treturn value.then(_empty);\n\t}\n}\n\n// Asynchronously iterate through an object that has a length property, passing the index as the first argument to the callback (even as the length property changes)\nexport function _forTo(array, body, check) {\n\tvar i = -1, pact, reject;\n\tfunction _cycle(result) {\n\t\ttry {\n\t\t\twhile (++i < array.length && (!check || !check())) {\n\t\t\t\tresult = body(i);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pact) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t} else {\n\t\t\t\tpact = result;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t}\n\t}\n\t_cycle();\n\treturn pact;\n}\n\n// Asynchronously iterate through an object's properties (including properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forIn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tkeys.push(key);\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\n// Asynchronously iterate through an object's own properties (excluding properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forOwn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tif (Object.prototype.hasOwnProperty.call(target, key)) {\n\t\t\tkeys.push(key);\n\t\t}\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\nexport const _iteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))) : \"@@iterator\";\n\n// Asynchronously iterate through an object's values\n// Uses for...of if the runtime supports it, otherwise iterates until length on a copy\nexport function _forOf(target, body, check) {\n\tif (typeof target[_iteratorSymbol] === \"function\") {\n\t\tvar iterator = target[_iteratorSymbol](), step, pact, reject;\n\t\tfunction _cycle(result) {\n\t\t\ttry {\n\t\t\t\twhile (!(step = iterator.next()).done && (!check || !check())) {\n\t\t\t\t\tresult = body(step.value);\n\t\t\t\t\tif (result && result.then) {\n\t\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pact) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t} else {\n\t\t\t\t\tpact = result;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t\t}\n\t\t}\n\t\t_cycle();\n\t\tif (iterator.return) {\n\t\t\tvar _fixup = function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!step.done) {\n\t\t\t\t\t\titerator.return();\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (pact && pact.then) {\n\t\t\t\treturn pact.then(_fixup, function(e) {\n\t\t\t\t\tthrow _fixup(e);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_fixup();\n\t\t}\n\t\treturn pact;\n\t}\n\t// No support for Symbol.iterator\n\tif (!(\"length\" in target)) {\n\t\tthrow new TypeError(\"Object is not iterable\");\n\t}\n\t// Handle live collections properly\n\tvar values = [];\n\tfor (var i = 0; i < target.length; i++) {\n\t\tvalues.push(target[i]);\n\t}\n\treturn _forTo(values, function(i) { return body(values[i]); }, check);\n}\n\nexport const _asyncIteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\"))) : \"@@asyncIterator\";\n\n// Asynchronously iterate on a value using it's async iterator if present, or its synchronous iterator if missing\nexport function _forAwaitOf(target, body, check) {\n\tif (typeof target[_asyncIteratorSymbol] === \"function\") {\n\t\tvar pact = new _Pact();\n\t\tvar iterator = target[_asyncIteratorSymbol]();\n\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\treturn pact;\n\t\tfunction _resumeAfterBody(result) {\n\t\t\tif (check && check()) {\n\t\t\t\treturn _settle(pact, 1, iterator.return ? iterator.return().then(function() { return result; }) : result);\n\t\t\t}\n\t\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\t}\n\t\tfunction _resumeAfterNext(step) {\n\t\t\tif (step.done) {\n\t\t\t\t_settle(pact, 1);\n\t\t\t} else {\n\t\t\t\tPromise.resolve(body(step.value)).then(_resumeAfterBody).then(void 0, _reject);\n\t\t\t}\n\t\t}\n\t\tfunction _reject(error) {\n\t\t\t_settle(pact, 2, iterator.return ? iterator.return().then(function() { return error; }) : error);\n\t\t}\n\t}\n\treturn Promise.resolve(_forOf(target, function(value) { return Promise.resolve(value).then(body); }, check));\n}\n\n// Asynchronously implement a generic for loop\nexport function _for(test, update, body) {\n\tvar stage;\n\tfor (;;) {\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t\tif (shouldContinue.then) {\n\t\t\tstage = 0;\n\t\t\tbreak;\n\t\t}\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.s;\n\t\t\t} else {\n\t\t\t\tstage = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (update) {\n\t\t\tvar updateValue = update();\n\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\tstage = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvar pact = new _Pact();\n\tvar reject = _settle.bind(null, pact, 2);\n\t(stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tdo {\n\t\t\tif (update) {\n\t\t\t\tupdateValue = update();\n\t\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\t\tupdateValue.then(_resumeAfterUpdate).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tshouldContinue = test();\n\t\t\tif (!shouldContinue || (_isSettledPact(shouldContinue) && !shouldContinue.v)) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t}\n\t\t} while (!result || !result.then);\n\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterBody(result);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n\tfunction _resumeAfterUpdate() {\n\t\tif (shouldContinue = test()) {\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterTest(shouldContinue);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a do ... while loop\nexport function _do(body, test) {\n\tvar awaitBody;\n\tdo {\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t} else {\n\t\t\t\tawaitBody = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t} while (!shouldContinue.then);\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : shouldContinue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tfor (;;) {\n\t\t\tshouldContinue = test();\n\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t}\n\t\t\tif (!shouldContinue) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\tresult = result.v;\n\t\t\t\t} else {\n\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tdo {\n\t\t\t\tresult = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tshouldContinue = test();\n\t\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t\t}\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} while (!shouldContinue.then);\n\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a switch statement\nexport function _switch(discriminant, cases) {\n\tvar dispatchIndex = -1;\n\tvar awaitBody;\n\touter: {\n\t\tfor (var i = 0; i < cases.length; i++) {\n\t\t\tvar test = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvar testValue = test();\n\t\t\t\tif (testValue && testValue.then) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tif (testValue === discriminant) {\n\t\t\t\t\tdispatchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Found the default case, set it as the pending dispatch case\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tif (dispatchIndex !== -1) {\n\t\t\tdo {\n\t\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\t\twhile (!body) {\n\t\t\t\t\tdispatchIndex++;\n\t\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t\t}\n\t\t\t\tvar result = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tawaitBody = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\t\tdispatchIndex++;\n\t\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t\treturn result;\n\t\t}\n\t}\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : testValue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterTest(value) {\n\t\tfor (;;) {\n\t\t\tif (value === discriminant) {\n\t\t\t\tdispatchIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (++i === cases.length) {\n\t\t\t\tif (dispatchIndex !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvalue = test();\n\t\t\t\tif (value && value.then) {\n\t\t\t\t\tvalue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tvar result = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tdispatchIndex++;\n\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterBody(result) {\n\t\tfor (;;) {\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tif (!fallthroughCheck || fallthroughCheck()) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdispatchIndex++;\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _call(body, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(body()) : body();\n\t}\n\ttry {\n\t\tvar result = Promise.resolve(body());\n\t\treturn then ? result.then(then) : result;\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\n// Asynchronously call a function and swallow the result\nexport function _callIgnored(body, direct) {\n\treturn _call(body, _empty, direct);\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _invoke(body, then) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(then);\n\t}\n\treturn then(result);\n}\n\n// Asynchronously call a function and swallow the result\nexport function _invokeIgnored(body) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(_empty);\n\t}\n}\n\n// Asynchronously call a function and send errors to recovery continuation\nexport function _catch(body, recover) {\n\ttry {\n\t\tvar result = body();\n\t} catch(e) {\n\t\treturn recover(e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(void 0, recover);\n\t}\n\treturn result;\n}\n\n// Asynchronously await a promise and pass the result to a finally continuation\nexport function _finallyRethrows(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer(true, e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n\t}\n\treturn finalizer(false, result);\n}\n\n// Asynchronously await a promise and invoke a finally continuation that always overrides the result\nexport function _finally(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer();\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer, finalizer);\n\t}\n\treturn finalizer();\n}\n\n// Rethrow or return a value from a finally continuation\nexport function _rethrow(thrown, value) {\n\tif (thrown)\n\t\tthrow value;\n\treturn value;\n}\n\n// Empty function to implement break and other control flow that ignores asynchronous results\nexport function _empty() {\n}\n\n// Sentinel value for early returns in generators \nexport const _earlyReturn = /*#__PURE__*/ {};\n\n// Asynchronously call a function and send errors to recovery continuation, skipping early returns\nexport function _catchInGenerator(body, recover) {\n\treturn _catch(body, function(e) {\n\t\tif (e === _earlyReturn) {\n\t\t\tthrow e;\n\t\t}\n\t\treturn recover(e);\n\t});\n}\n\n// Asynchronous generator class; accepts the entrypoint of the generator, to which it passes itself when the generator should start\nexport const _AsyncGenerator = /*#__PURE__*/(function() {\n\tfunction _AsyncGenerator(entry) {\n\t\tthis._entry = entry;\n\t\tthis._pact = null;\n\t\tthis._resolve = null;\n\t\tthis._return = null;\n\t\tthis._promise = null;\n\t}\n\n\tfunction _wrapReturnedValue(value) {\n\t\treturn { value: value, done: true };\n\t}\n\tfunction _wrapYieldedValue(value) {\n\t\treturn { value: value, done: false };\n\t}\n\n\t_AsyncGenerator.prototype._yield = function(value) {\n\t\t// Yield the value to the pending next call\n\t\tthis._resolve(value && value.then ? value.then(_wrapYieldedValue) : _wrapYieldedValue(value));\n\t\t// Return a pact for an upcoming next/return/throw call\n\t\treturn this._pact = new _Pact();\n\t};\n\t_AsyncGenerator.prototype.next = function(value) {\n\t\t// Advance the generator, starting it if it has yet to be started\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tconst _entry = _this._entry;\n\t\t\t\tif (_entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the next call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Start the generator\n\t\t\t\t_this._entry = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\tfunction returnValue(value) {\n\t\t\t\t\t_this._resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t_this._resolve = null;\n\t\t\t\t}\n\t\t\t\tvar result = _entry(_this);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tresult.then(returnValue, function(error) {\n\t\t\t\t\t\tif (error === _earlyReturn) {\n\t\t\t\t\t\t\treturnValue(_this._return);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst pact = new _Pact();\n\t\t\t\t\t\t\t_this._resolve(pact);\n\t\t\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t\t\t_this._resolve = null;\n\t\t\t\t\t\t\t_resolve(pact, 2, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturnValue(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Generator is started and a yield expression is pending, settle it\n\t\t\t\t_this._pact = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\t_settle(_pact, 1, value);\n\t\t\t}\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.return = function(value) {\n\t\t// Early return from the generator if started, otherwise abandons the generator\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the return call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return the specified value\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t}\n\t\t\t// Settle the yield expression with a rejected \"early return\" value\n\t\t\t_this._return = value;\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, _earlyReturn);\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.throw = function(error) {\n\t\t// Inject an exception into the pending yield expression\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve, reject) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the throw call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return a rejected Promise containing the error\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\t// Settle the yield expression with the value as a rejection\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, error);\n\t\t});\n\t};\n\n\t_AsyncGenerator.prototype[_asyncIteratorSymbol] = function() {\n\t\treturn this;\n\t};\n\t\n\treturn _AsyncGenerator;\n})();\n","import { NacelleConnector } from '../connectors/nacelleConnector'\nimport {\n  FetchProductParams,\n  FetchProductsParams,\n  FetchCollectionParams,\n  FetchCollectionPageParams,\n  FetchContentParams,\n  FetchPageParams,\n  FetchPagesParams,\n  FetchArticleParams,\n  FetchArticlesParams,\n  FetchBlogParams,\n  FetchBlogPageParams,\n} from '../connectors/interfaces/parameters'\nimport { Product } from '../objects/product'\nimport { Collection } from '../objects/collection'\nimport { Content } from '../objects/content'\nimport { Space } from '../objects/space'\n\nexport interface NacelleDataParams {\n  connector: NacelleConnector\n  locale?: string\n  currencyCode?: string\n  onDataError?: <T>(options: OnDataErrorParams) => Promise<T> | T\n}\n\nexport interface NacelleDataUpdateParams {\n  connector?: NacelleConnector\n  locale?: string\n  currencyCode?: string\n  onDataError?: <T>(options: OnDataErrorParams) => Promise<T> | T\n}\n\ninterface AfterSubscription {\n  method: string\n  callback: <T>(responseObj: T) => Promise<T> | T\n}\n\ninterface OnDataErrorParams {\n  method: string\n  params: any\n  error: Error\n}\n\ninterface OnDataError {\n  <T>(options: OnDataErrorParams): Promise<T> | T\n}\n\nexport default class NacelleData {\n  connector: NacelleConnector\n  locale: string\n  currencyCode: string\n  afterSubscriptions: AfterSubscription[]\n  onDataError: OnDataError | null\n\n  constructor(params: NacelleDataParams) {\n    this.connector = params.connector\n    this.locale = params.locale || 'en-us'\n    this.currencyCode = params.currencyCode || 'USD'\n    this.afterSubscriptions = []\n    this.onDataError = null\n\n    if (params.onDataError) {\n      this.onDataError = params.onDataError\n    }\n\n    this.connector.updateDefaults({\n      locale: this.locale,\n    })\n  }\n\n  update(params: NacelleDataUpdateParams) {\n    if (params.connector) {\n      this.connector = params.connector\n    }\n\n    if (params.locale) {\n      this.locale = params.locale\n\n      this.connector.updateDefaults({\n        locale: this.locale,\n      })\n    }\n\n    if (params.currencyCode) {\n      this.currencyCode = params.currencyCode\n    }\n\n    if (typeof params.onDataError !== 'undefined') {\n      this.onDataError = params.onDataError\n    }\n  }\n\n  async product(\n    params: FetchProductParams,\n    connector?: NacelleConnector\n  ): Promise<Product> {\n    try {\n      let product: Product\n\n      if (connector) {\n        product = await connector.product(params)\n      } else {\n        product = await this.connector.product(params)\n      }\n\n      return this.applyAfter<Product>('product', product)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Product>({\n          method: 'product',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async products(\n    params: FetchProductsParams,\n    connector?: NacelleConnector\n  ): Promise<Product[]> {\n    try {\n      let products: Product[]\n\n      if (connector) {\n        products = await connector.products(params)\n      } else {\n        products = await this.connector.products(params)\n      }\n\n      return this.applyAfter<Product[]>('products', products)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Product[]>({\n          method: 'products',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async collection(\n    params: FetchCollectionParams,\n    connector?: NacelleConnector\n  ): Promise<Collection> {\n    try {\n      let collection: Collection\n\n      if (connector) {\n        collection = await connector.collection(params)\n      } else {\n        collection = await this.connector.collection(params)\n      }\n\n      return this.applyAfter<Collection>('collection', collection)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Collection>({\n          method: 'collection',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async collectionPage(\n    params: FetchCollectionPageParams,\n    connector?: NacelleConnector\n  ): Promise<Product[]> {\n    try {\n      let products: Product[]\n      if (connector) {\n        products = await connector.collectionPage(params)\n      } else {\n        products = await this.connector.collectionPage(params)\n      }\n\n      return this.applyAfter<Product[]>('collectionPage', products)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Product[]>({\n          method: 'collectionPage',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async content(\n    params: FetchContentParams,\n    connector?: NacelleConnector\n  ): Promise<Content> {\n    try {\n      let content: Content\n\n      if (connector) {\n        content = await connector.content(params)\n      } else {\n        content = await this.connector.content(params)\n      }\n\n      return this.applyAfter<Content>('content', content)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Content>({\n          method: 'content',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async page(\n    params: FetchPageParams,\n    connector?: NacelleConnector\n  ): Promise<Content> {\n    try {\n      let page: Content\n\n      if (connector) {\n        page = await connector.page(params)\n      } else {\n        page = await this.connector.page(params)\n      }\n\n      return this.applyAfter<Content>('page', page)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Content>({\n          method: 'page',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async pages(\n    params: FetchPagesParams,\n    connector?: NacelleConnector\n  ): Promise<Content[]> {\n    try {\n      let pages: Content[]\n\n      if (connector) {\n        pages = await connector.pages(params)\n      } else {\n        pages = await this.connector.pages(params)\n      }\n\n      return this.applyAfter<Content[]>('pages', pages)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Content[]>({\n          method: 'pages',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async article(\n    params: FetchArticleParams,\n    connector?: NacelleConnector\n  ): Promise<Content> {\n    try {\n      let article: Content\n\n      if (connector) {\n        article = await connector.article(params)\n      } else {\n        article = await this.connector.article(params)\n      }\n\n      return this.applyAfter<Content>('article', article)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Content>({\n          method: 'article',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async articles(\n    params: FetchArticlesParams,\n    connector?: NacelleConnector\n  ): Promise<Content[]> {\n    try {\n      let articles: Content[]\n\n      if (connector) {\n        articles = await connector.articles(params)\n      } else {\n        articles = await this.connector.articles(params)\n      }\n\n      return this.applyAfter<Content[]>('articles', articles)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Content[]>({\n          method: 'articles',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async blog(\n    params: FetchBlogParams,\n    connector?: NacelleConnector\n  ): Promise<Content> {\n    try {\n      let blog: Content\n\n      if (connector) {\n        blog = await connector.blog(params)\n      } else {\n        blog = await this.connector.blog(params)\n      }\n\n      return this.applyAfter<Content>('blog', blog)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Content>({\n          method: 'blog',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async blogPage(\n    params: FetchBlogPageParams,\n    connector?: NacelleConnector\n  ): Promise<Content[]> {\n    try {\n      let articles: Content[]\n\n      if (connector) {\n        articles = await connector.blogPage(params)\n      } else {\n        articles = await this.connector.blogPage(params)\n      }\n\n      return this.applyAfter<Content[]>('blogPage', articles)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Content[]>({\n          method: 'blogPage',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async space(connector?: NacelleConnector): Promise<Space> {\n    try {\n      let space: Space\n\n      if (connector) {\n        space = await connector.space()\n      } else {\n        space = await this.connector.space()\n      }\n\n      return this.applyAfter<Space>('space', space)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Space>({\n          method: 'space',\n          params: {},\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async allProducts(\n    params?: { limit?: number },\n    connector?: NacelleConnector\n  ): Promise<Product[]> {\n    try {\n      let products: Product[]\n\n      if (connector) {\n        products = await connector.allProducts(params)\n      } else {\n        products = await this.connector.allProducts(params)\n      }\n\n      return this.applyAfter<Product[]>('allProducts', products)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Product[]>({\n          method: 'allProducts',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async allCollections(\n    params?: { limit?: number },\n    connector?: NacelleConnector\n  ): Promise<Collection[]> {\n    try {\n      let collections: Collection[]\n\n      if (connector) {\n        collections = await connector.allCollections(params)\n      } else {\n        collections = await this.connector.allCollections(params)\n      }\n\n      return this.applyAfter<Collection[]>('allCollections', collections)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Collection[]>({\n          method: 'allCollections',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async allContent(\n    params?: { limit?: number },\n    connector?: NacelleConnector\n  ): Promise<Content[]> {\n    try {\n      let content: Content[]\n\n      if (connector) {\n        content = await connector.allContent(params)\n      } else {\n        return this.connector.allContent(params)\n      }\n\n      return this.applyAfter<Content[]>('allContent', content)\n    } catch (error) {\n      if (this.onDataError) {\n        return this.onDataError<Content[]>({\n          method: 'allContent',\n          params,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  after(method: string, callback: <T>(responseObj: T) => Promise<T> | T): void {\n    this.afterSubscriptions.push({\n      method,\n      callback,\n    })\n  }\n\n  private async applyAfter<T>(method: string, responseObj: T): Promise<T> {\n    let response = responseObj\n    const subs = this.afterSubscriptions.filter((sub) => sub.method === method)\n\n    for (const sub of subs) {\n      response = await sub.callback<T>(response)\n    }\n\n    return response\n  }\n}\n","import axios, { AxiosRequestConfig, AxiosInstance } from 'axios'\nimport HttpClient from './HttpClient'\nimport HttpClientReponse from './HttpClientResponse'\n\nexport default class HttpClientAxios implements HttpClient {\n  client: AxiosInstance\n\n  constructor(options?: AxiosRequestConfig) {\n    this.client = axios.create({\n      responseType: 'json',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      timeout: 240000,\n      maxContentLength: 524328890,\n      ...options,\n    })\n  }\n\n  get<T>(url: string): Promise<HttpClientReponse<T>> {\n    return this.client.get(url)\n  }\n\n  post<T>(url: string, data: object): Promise<HttpClientReponse<T>> {\n    return this.client.post(url, data)\n  }\n}\n","import HttpClient from '../util/http/HttpClient'\nimport HttpClientAxios from '../util/http/HttpClientAxios'\nimport { Product } from '../objects/product'\nimport { Collection } from '../objects/collection'\nimport { Content } from '../objects/content'\nimport { Space } from '../objects/space'\nimport {\n  FetchProductParams,\n  FetchProductsParams,\n  FetchCollectionParams,\n  FetchCollectionPageParams,\n  FetchContentParams,\n  FetchPageParams,\n  FetchPagesParams,\n  FetchBlogParams,\n  FetchArticleParams,\n  FetchArticlesParams,\n  FetchBlogPageParams,\n  UpdateParams,\n} from './interfaces/parameters'\n\nexport interface NacelleConnectorParams {\n  locale?: string\n  httpClient?: HttpClient\n}\n\nexport class NacelleConnector {\n  apiClient: HttpClient\n  locale: string\n\n  constructor(params?: NacelleConnectorParams) {\n    this.apiClient =\n      params && params.httpClient ? params.httpClient : new HttpClientAxios()\n    this.locale = params && params.locale ? params.locale : 'en-us'\n  }\n\n  updateDefaults(params?: UpdateParams) {\n    if (params && params.locale) {\n      this.locale = params.locale\n    }\n  }\n\n  async product(_options: FetchProductParams): Promise<Product> {\n    throw new Error('The default NacelleConnector does not return a product')\n  }\n\n  async products(_options: FetchProductsParams): Promise<Product[]> {\n    throw new Error('The default NacelleConnector does not return products')\n  }\n\n  async collection(_options: FetchCollectionParams): Promise<Collection> {\n    throw new Error('The default NacelleConnector does not return a collection')\n  }\n\n  async collectionPage(\n    _options: FetchCollectionPageParams\n  ): Promise<Product[]> {\n    throw new Error(\n      'The default NacelleConnector does not return a collection page'\n    )\n  }\n\n  async content(_options: FetchContentParams): Promise<Content> {\n    throw new Error('This NacelleConnector does not return a content item')\n  }\n\n  async page(_options: FetchPageParams): Promise<Content> {\n    throw new Error('This NacelleConnector does not return a page item')\n  }\n\n  async pages(_options: FetchPagesParams): Promise<Content[]> {\n    throw new Error('This NacelleConnector does not return pages')\n  }\n\n  async blog(_options: FetchBlogParams): Promise<Content> {\n    throw new Error('This NacelleConnector does not return a blog')\n  }\n\n  async article(_options: FetchArticleParams): Promise<Content> {\n    throw new Error('This NacelleConnector does not return an article')\n  }\n\n  async articles(_options: FetchArticlesParams): Promise<Content[]> {\n    throw new Error('This NacelleConnector does not return an article')\n  }\n\n  async blogPage(_options: FetchBlogPageParams): Promise<Content[]> {\n    throw new Error('This NacelleConnector does not return a blog page')\n  }\n\n  async space(): Promise<Space> {\n    throw new Error('This NacelleConnector does not return a space')\n  }\n\n  async allProducts(_options?: { limit?: number }): Promise<Product[]> {\n    throw new Error('This NacelleConnector does not return all products')\n  }\n\n  async allCollections(_options?: { limit?: number }): Promise<Collection[]> {\n    throw new Error('This NacelleConnector does not return all collections')\n  }\n\n  async allContent(_options?: { limit?: number }): Promise<Content[]> {\n    throw new Error('This NacelleConnector does not return all content')\n  }\n}\n","import { ItemList } from '../../../objects/itemList'\n\nexport default (selectedList = 'default', lists: Array<ItemList>): ItemList => {\n  const selected = lists.find(({ slug }) => slug === selectedList)\n  if (selected !== undefined) {\n    return selected\n  } else {\n    throw new Error('No default product list found')\n  }\n}\n","import getList from './getList'\nimport { ItemList } from '../../../objects/itemList'\n\ninterface GetListHandlesOptions {\n  paginate?: boolean\n  selectedList?: string\n  index?: number\n  itemsPerPage?: number\n}\n\nexport default (\n  lists: Array<ItemList>,\n  options: GetListHandlesOptions = {}\n): Array<string> => {\n  const { paginate, selectedList, index = 0, itemsPerPage = 30 } = options\n  const list = getList(selectedList, lists)\n\n  if (list && list.handles) {\n    if (paginate) {\n      return list.handles.slice(index, index + itemsPerPage)\n    }\n\n    return list.handles\n  }\n\n  throw new Error('Selected list does not have array of handles')\n}\n","import { Media } from './media'\nimport { Metafield } from './metafield'\nimport { Variant } from './variant'\n\nexport interface ProductOptions {\n  id?: string\n  handle?: string\n  locale?: string\n  globalHandle?: string\n  pimSyncSourceDomain?: string\n  pimSyncSource?: string\n  pimSyncSourceProductId?: string\n  title?: string\n  description?: string\n  priceRange?: PriceRange\n  productType?: string\n  featuredMedia?: Media\n  availableForSale?: boolean\n  vendor?: string\n  tags?: Array<string>\n  media?: Array<Media>\n  metafields?: Array<Metafield>\n  variants?: Array<Variant>\n  createdAt?: number\n  updatedAt?: number\n  indexedAt?: number\n}\n\ninterface PriceRange {\n  min: string\n  max: string\n  currencyCode: string\n}\n\nexport interface Product {\n  id: string\n  handle: string\n  locale: string\n  globalHandle: string\n  pimSyncSourceDomain: string\n  pimSyncSource?: string\n  pimSyncSourceProductId?: string\n  title: string\n  description: string\n  priceRange: PriceRange\n  productType?: string\n  featuredMedia?: Media\n  availableForSale: boolean\n  vendor?: string\n  tags: Array<string>\n  media: Array<Media>\n  metafields: Array<Metafield>\n  variants: Array<Variant>\n  createdAt?: number\n  updatedAt?: number\n  indexedAt: number\n}\n\nexport const createProduct = (options: ProductOptions): Product => {\n  const product: Product = {\n    id: '',\n    handle: '',\n    locale: 'en-us',\n    globalHandle: '',\n    pimSyncSourceDomain: '',\n    title: '',\n    description: '',\n    priceRange: {\n      min: '0.0',\n      max: '0.0',\n      currencyCode: 'USD',\n    },\n    availableForSale: true,\n    tags: [],\n    media: [],\n    metafields: [],\n    variants: [],\n    indexedAt: 0,\n    ...options,\n  }\n\n  return product\n}\n","export interface MediaOptions {\n  id?: string\n  type?: string\n  src?: string\n  thumbnailSrc?: string\n  altText?: string\n}\n\nexport interface Media {\n  id: string\n  type: string\n  src: string\n  thumbnailSrc: string\n  altText: string\n}\n\nexport const createMedia = (options: MediaOptions): Media => {\n  return {\n    id: '',\n    type: 'image',\n    src: '',\n    thumbnailSrc: '',\n    altText: '',\n    ...options,\n  }\n}\n","export interface ItemList {\n  title: string\n  slug: string\n  locale: string\n  handles: Array<string>\n}\n\nexport interface CreateItemListOptions {\n  title?: string\n  slug?: string\n  locale?: string\n  handles?: Array<string>\n}\n\nexport const createItemList = (obj: CreateItemListOptions): ItemList => {\n  const list: ItemList = {\n    title: '',\n    slug: 'default',\n    locale: 'en-us',\n    handles: [],\n    ...obj,\n  }\n\n  return list\n}\n","import { Media, createMedia } from './media'\nimport { ItemList, createItemList } from './itemList'\nimport { Metafield } from './metafield'\n\nexport interface Collection {\n  id: string\n  handle: string\n  locale: string\n  globalHandle: string\n  pimSyncSourceDomain: string\n  pimSyncSource?: string\n  pimSyncSourceCollectionId?: string\n  title?: string\n  description?: string\n  featuredMedia?: Media\n  productLists: Array<ItemList>\n  createdAt?: number\n  updatedAt?: number\n  metafields: Array<Metafield>\n}\n\nexport interface CreateCollectionOptions {\n  id?: string\n  handle?: string\n  locale?: string\n  globalHandle?: string\n  pimSyncSourceDomain?: string\n  pimSyncSource?: string\n  pimSyncSourceCollectionId?: string\n  title?: string\n  description?: string\n  featuredMedia?: Media | null\n  productLists?: Array<ItemList>\n  createdAt?: number\n  updatedAt?: number\n  metafields?: Array<Metafield>\n}\n\nexport const createCollection = (obj: CreateCollectionOptions): Collection => {\n  const { productLists, featuredMedia, ...rest } = obj\n\n  const collection = {\n    id: '',\n    handle: '',\n    locale: 'en-us',\n    globalHandle: '',\n    pimSyncSourceDomain: '',\n    productLists: [] as ItemList[],\n    featuredMedia: null as Media | null,\n    ...rest,\n    metafields: obj.metafields || [],\n  }\n\n  if (productLists && Array.isArray(productLists)) {\n    collection.productLists = productLists.map((list) => {\n      return createItemList(list)\n    })\n  }\n\n  if (featuredMedia) {\n    collection.featuredMedia = createMedia(featuredMedia)\n  }\n\n  return collection as Collection\n}\n","export default (tags: string[]): { [key: string]: string } => {\n  if (Array.isArray(tags)) {\n    const tagFields = tags.reduce((fields, tag) => {\n      if (tag.includes('field::')) {\n        const [, key, value] = tag.split('::')\n        fields[key] = value\n      }\n\n      return fields\n    }, {} as { [key: string]: string })\n\n    return {\n      ...tagFields,\n    }\n  }\n\n  return {}\n}\n","import createFieldsFromTags from '../util/createFieldsFromTags'\n\nexport interface ContentSection {\n  title?: string\n  handle?: string\n  cmsSyncSource?: string\n  contentHtml?: string\n  contentType?: string\n  tags?: string[]\n  [key: string]: any\n}\n\nexport const mapContentSections = (\n  sections: string | ContentSection[],\n  cmsSyncSource: string\n): ContentSection[] => {\n  const formattedSections =\n    typeof sections === 'string' ? JSON.parse(sections) : sections\n\n  if (Array.isArray(formattedSections)) {\n    return formattedSections.map((section) => {\n      if (section.tags) {\n        const fieldTags = createFieldsFromTags(section.tags)\n\n        return {\n          ...section,\n          ...fieldTags,\n          cmsSyncSource,\n        }\n      }\n\n      return {\n        ...section,\n        cmsSyncSource,\n      }\n    })\n  }\n\n  return []\n}\n","import { Media, createMedia } from './media'\nimport { ItemList, createItemList } from './itemList'\nimport { Author } from './author'\nimport { ContentSection, mapContentSections } from './contentSection'\nimport { RelatedArticle } from './relatedArticle'\n\nexport interface Content {\n  id: string\n  handle: string\n  locale: string\n  globalHandle: string\n  cmsSyncSource: string\n  cmsSyncSourceDomain: string\n  cmsSyncSourceContentId?: string\n  type: string\n  title?: string\n  description?: string\n  sections?: ContentSection[]\n  tags?: Array<string>\n  fields?: object\n  articleLists?: Array<ItemList>\n  relatedArticles?: Array<RelatedArticle>\n  collectionHandle?: string\n  content?: string\n  contentHtml?: string\n  excerpt?: string\n  blogHandle?: string\n  featuredMedia?: Media\n  author?: Author\n  publishDate?: number\n  createdAt?: number\n  updatedAt?: number\n  indexedAt: number\n}\n\nexport interface CreateContentOptions {\n  id?: string\n  handle?: string\n  locale?: string\n  globalHandle?: string\n  cmsSyncSource?: string\n  cmsSyncSourceDomain?: string\n  cmsSyncSourceContentId?: string\n  type?: string\n  title?: string\n  description?: string\n  sections?: string | ContentSection[]\n  tags?: Array<string>\n  fields?: object\n  articleLists?: Array<ItemList> | null\n  relatedArticles?: Array<RelatedArticle>\n  collectionHandle?: string\n  content?: string\n  contentHtml?: string\n  excerpt?: string\n  blogHandle?: string\n  featuredMedia?: Media | null\n  author?: Author\n  publishDate?: number\n  createdAt?: number\n  updatedAt?: number\n  indexedAt?: number\n}\n\nexport const createContent = (obj: CreateContentOptions): Content => {\n  const { articleLists, featuredMedia, sections, ...rest } = obj\n  const content = {\n    id: '',\n    handle: '',\n    locale: '',\n    globalHandle: '',\n    cmsSyncSource: '',\n    cmsSyncSourceDomain: '',\n    cmsSyncSourceContentId: '',\n    type: 'content',\n    indexedAt: 0,\n    articleLists: null as null | ItemList[],\n    featuredMedia: null as null | Media,\n    relatedArticles: [],\n    ...rest,\n  } as Content\n\n  if (sections) {\n    content.sections = mapContentSections(sections, content.cmsSyncSource)\n  }\n\n  if (articleLists && Array.isArray(articleLists)) {\n    content.articleLists = articleLists.map((list: ItemList) => {\n      return createItemList(list)\n    })\n  }\n\n  if (featuredMedia) {\n    content.featuredMedia = createMedia(featuredMedia)\n  }\n\n  return content\n}\n","import { Metafield } from './metafield'\n\nexport interface Link {\n  title: string\n  to: string\n  type: string\n  links?: Array<Link>\n}\n\nexport interface Linklist {\n  handle: string\n  links: Array<Link>\n}\n\nexport interface Space {\n  id: string\n  name: string\n  domain: string\n  linklists: Array<Linklist>\n  metafields: Array<Metafield>\n}\n\nexport interface CreateSpaceOptions {\n  id?: string\n  name?: string\n  domain?: string\n  linklists?: Array<Linklist>\n  metafields?: Array<Metafield>\n}\n\nexport const createSpace = (obj: CreateSpaceOptions): Space => {\n  const { id, name, domain, linklists, metafields } = obj\n  const space = {\n    id: id || '',\n    name: name || '',\n    domain: domain || '',\n    linklists: Array.isArray(linklists) ? linklists : [],\n    metafields: Array.isArray(metafields) ? metafields : [],\n  }\n\n  return space\n}\n","export default `\n  id\n  thumbnailSrc\n  src\n  type\n  altText\n`\n","export default `\n  id\n  namespace\n  key\n  value\n`\n","import mediaFragment from './mediaFragment'\nimport metafieldFragment from './metafieldFragment'\n\nexport default `\n  id\n  handle\n  locale\n  globalHandle\n  pimSyncSource\n  pimSyncSourceDomain\n  pimSyncSourceProductId\n  title\n  description\n  priceRange {\n    min\n    max\n    currencyCode\n  }\n  productType\n  media {\n    ${mediaFragment}\n  }\n  featuredMedia {\n    ${mediaFragment}\n  }\n  availableForSale\n  vendor\n  tags\n  createdAt\n  metafields {\n    ${metafieldFragment}\n  }\n  indexedAt\n  variants {\n    id\n    title\n    price\n    priceCurrency\n    compareAtPrice\n    compareAtPriceCurrency\n    swatchSrc\n    selectedOptions {\n      name\n      value\n    }\n    featuredMedia {\n      ${mediaFragment}\n    }\n    sku\n    availableForSale\n    metafields {\n      ${metafieldFragment}\n    }\n    weight\n    weightUnit\n    priceRules {\n      id\n      handle\n      title\n      price\n      priceCurrency\n      comparedAtPrice\n       metafields {\n          ${metafieldFragment}\n        }\n      priceBreaks {\n        quantityMin\n        quantityMax\n        price\n        metafields {\n          ${metafieldFragment}\n        }\n      }\n      availableTo\n    }\n  }\n`\n","import productFragment from '../fragments/productFragment'\n\nexport default `\nquery getProducts($first: Int, $after: String) {\n  getProducts(first: $first, after: $after) {\n    items {\n      ${productFragment}\n    }\n    nextToken\n  }\n}\n`\n","import mediaFragment from './mediaFragment'\nimport metafieldFragment from './metafieldFragment'\n\nexport default `\n  id\n  handle\n  globalHandle\n  locale\n  pimSyncSourceDomain\n  pimSyncSource\n  pimSyncSourceCollectionId\n  title\n  description\n  metafields {\n    ${metafieldFragment}\n  }\n  featuredMedia {\n    ${mediaFragment}\n  }\n  productLists {\n    title\n    slug\n    locale\n    handles\n  }\n`\n","import collectionFragment from '../fragments/collectionFragment'\n\nexport default `\nquery getCollections($first: Int, $after: String) {\n  getCollections(first: $first, after: $after) {\n    nextToken\n    items {\n      ${collectionFragment}\n    }\n  }\n}\n`\n","import mediaFragment from '../fragments/mediaFragment'\n\nexport default `\nquery getContent($first: Int, $after: String) {\n  getContent(first: $first, after: $after) {\n    nextToken\n    items {\n      id\n      handle\n      locale\n      globalHandle\n      cmsSyncSource\n      cmsSyncSourceDomain\n      cmsSyncSourceContentId\n      type\n      indexedAt\n      title\n      description\n      sections\n      tags\n      fields\n      articleLists {\n        title\n        slug\n        locale\n        handles\n      }\n      relatedArticles {\n        handle\n        title\n        blogHandle\n        cmsSyncSourceContentId\n        locale\n        createdAt\n        updatedAt\n        author {\n          firstName\n          lastName\n          bio\n          email\n        }\n        featuredMedia {\n          ${mediaFragment}\n        }\n        publishDate\n        description\n        excerpt\n        tags\n      }\n      collectionHandle\n      content\n      contentHtml\n      excerpt\n      blogHandle\n      featuredMedia {\n        ${mediaFragment}\n      }\n      publishDate\n      author {\n        firstName\n        lastName\n        bio\n        email\n      }\n      createdAt\n      updatedAt\n    }\n  }\n}`\n","export default `\nquery GetSpace {\n  getSpace {\n    id\n    name\n    domain\n    metafields {\n      namespace\n      key\n      value\n    }\n    linklists {\n      handle\n      links {\n        title\n        to\n        type\n        links {\n          title\n          to\n          type\n          links {\n            title\n            to\n            type\n          }\n        }\n      }\n    }\n  }\n}`\n","export default `\nquery getCheckout($id: ID!, $url: String!) {\n  getCheckout(id: $id, url: $url) {\n    id\n    url\n    completed\n  }\n}\n`\n","export default `\nquery GetVariantAvailability($productId: String!, $variantId: String!) {\n  getVariantAvailability(productId: $productId, variantId: $variantId)\n}\n`\n","export default `\nmutation processCheckout($input: CheckoutInput) {\n  processCheckout(input: $input) {\n    id\n    url\n    completed\n  }\n}\n`\n","import productFragment from '../fragments/productFragment'\n\nexport default `\nquery getProductByHandle($handle: String!, $locale: String) {\n  getProductByHandle(handle: $handle, locale: $locale) {\n    ${productFragment}\n  }\n}\n`\n","import collectionFragment from '../fragments/collectionFragment'\n\nexport default `\nquery getCollectionByHandle($handle: String!, $locale: String) {\n  getCollectionByHandle(handle: $handle, locale: $locale) {\n    ${collectionFragment}\n  }\n}\n`\n","export default `\nquery getContentByHandle($type: String!, $handle: String!, $locale: String, $blogHandle: String) {\n  getContentByHandle(type: $type, handle: $handle, locale: $locale, blogHandle: $blogHandle) {\n    id\n    handle\n    locale\n    globalHandle\n    cmsSyncSource\n    cmsSyncSourceDomain\n    cmsSyncSourceContentId\n    type\n    indexedAt\n    title\n    description\n    sections\n    tags\n    fields\n    articleLists {\n      title\n      slug\n      locale\n      handles\n    }\n    relatedArticles {\n      handle\n      title\n      blogHandle\n      cmsSyncSourceContentId\n      locale\n      createdAt\n      updatedAt\n      author {\n        firstName\n        lastName\n        bio\n        email\n      }\n      featuredMedia {\n        id\n        type\n        src\n        thumbnailSrc\n        altText\n      }\n      publishDate\n      description\n      excerpt\n      tags\n    }\n    collectionHandle\n    content\n    contentHtml\n    excerpt\n    blogHandle\n    featuredMedia {\n      id\n      type\n      src\n      thumbnailSrc\n      altText\n    }\n    publishDate\n    author {\n      firstName\n      lastName\n      bio\n      email\n    }\n    createdAt\n    updatedAt\n  }\n}`\n","import { NacelleConnector, NacelleConnectorParams } from '../nacelleConnector'\nimport {\n  FetchProductParams,\n  FetchProductsParams,\n  FetchCollectionParams,\n  FetchCollectionPageParams,\n  FetchContentParams,\n  FetchPageParams,\n  FetchPagesParams,\n  FetchBlogParams,\n  FetchArticleParams,\n  FetchArticlesParams,\n  FetchBlogPageParams,\n} from '../interfaces/parameters'\nimport HttpClientAxios from '../../util/http/HttpClientAxios'\nimport { GraphQLResponseRoot, GraphQLPageResponse } from './utils/interfaces'\nimport getListHandles from '../static/utils/getListHandles'\nimport { Product, ProductOptions, createProduct } from '../../objects/product'\nimport {\n  Collection,\n  CreateCollectionOptions,\n  createCollection,\n} from '../../objects/collection'\nimport {\n  Content,\n  CreateContentOptions,\n  createContent,\n} from '../../objects/content'\nimport { Space, CreateSpaceOptions, createSpace } from '../../objects/space'\nimport { CartItem, Checkout, CheckoutMetafield } from '../../objects/checkout'\nimport getProductsQuery from './queries/getProductsQuery'\nimport getCollectionsQuery from './queries/getCollectionsQuery'\nimport getContentQuery from './queries/getContentQuery'\nimport getSpaceQuery from './queries/getSpaceQuery'\nimport getCheckoutQuery from './queries/getCheckoutQuery'\nimport getVariantAvailabilityQuery from './queries/getVariantAvailabilityQuery'\nimport processCheckoutMutation from './mutations/processCheckoutMutation'\nimport getProductByHandleQuery from './queries/getProductByHandleQuery'\nimport getCollectionByHandleQuery from './queries/getCollectionByHandleQuery'\nimport getContentByHandleQuery from './queries/getContentByHandleQuery'\n\nexport interface NacelleGraphQLConnectorParams extends NacelleConnectorParams {\n  endpoint: string\n  spaceId: string\n  token: string\n}\n\nexport interface NacelleGraphQLRequestResponse<T> {\n  success: boolean\n  data: T | null\n  error?: string\n}\n\nexport interface ProcessCheckoutParams {\n  cartItems: CartItem[]\n  checkoutId: string\n  metafields: CheckoutMetafield[]\n  note: string\n}\n\nexport default class NacelleGraphQLConnector extends NacelleConnector {\n  endpoint: string\n  spaceId: string\n  token: string\n\n  constructor(params: NacelleGraphQLConnectorParams) {\n    super(params)\n\n    if (\n      typeof params.endpoint === 'undefined' ||\n      params.endpoint === null ||\n      params.endpoint === ''\n    ) {\n      throw new Error('NacelleGraphQLConnector requires a valid endpoint.')\n    }\n\n    if (\n      typeof params.spaceId === 'undefined' ||\n      params.spaceId === null ||\n      params.spaceId === ''\n    ) {\n      throw new Error(\n        'NacelleGraphQLConnector requires a valid Nacelle space id.'\n      )\n    }\n\n    if (\n      typeof params.token === 'undefined' ||\n      params.token === null ||\n      params.token === ''\n    ) {\n      throw new Error(\n        'NacelleGraphQLConnector requires a valid Nacelle space API token.'\n      )\n    }\n\n    this.endpoint = params.endpoint\n    this.spaceId = params.spaceId\n    this.token = params.token\n\n    this.apiClient =\n      params && params.httpClient\n        ? params.httpClient\n        : new HttpClientAxios({\n            headers: {\n              'Content-Type': 'application/json',\n              'x-nacelle-space-id': this.spaceId,\n              'x-nacelle-space-token': this.token,\n            },\n          })\n  }\n\n  async request<T>(\n    query: string,\n    queryName: string,\n    variables?: any\n  ): Promise<NacelleGraphQLRequestResponse<T>> {\n    try {\n      const data = {\n        query,\n        variables,\n      }\n      const response = await this.apiClient.post<GraphQLResponseRoot>(\n        this.endpoint,\n        data\n      )\n\n      if (response) {\n        if (\n          response.data &&\n          Array.isArray(response.data.errors) &&\n          response.data.errors.length > 0\n        ) {\n          const firstError = response.data.errors.pop()\n\n          if (firstError && firstError.message) {\n            throw new Error(firstError.message)\n          }\n\n          throw new Error(`Unknown graphql error attempting ${queryName}`)\n        }\n\n        if (\n          response.data.data &&\n          typeof response.data.data[queryName] !== 'undefined'\n        ) {\n          return {\n            success: true,\n            data: response.data.data[queryName],\n          }\n        } else {\n          throw new Error(\n            `Response did not include ${queryName}.\n            ${JSON.stringify(response.data, null, 2)}`\n          )\n        }\n      }\n\n      throw new Error(`No valid response from ${queryName}`)\n    } catch (error) {\n      return {\n        success: false,\n        error: error.message,\n        data: null,\n      }\n    }\n  }\n\n  async getAllPageItems<T>(params: {\n    query: string\n    queryName: string\n    first?: number\n  }): Promise<Array<T>> {\n    let after = ''\n    const pages = []\n\n    do {\n      const response = await this.request<GraphQLPageResponse<T>>(\n        params.query,\n        params.queryName,\n        {\n          first: params.first || 500,\n          after,\n        }\n      )\n\n      if (response.success && response.data) {\n        const page = response.data\n\n        pages.push(page)\n        after = page.nextToken\n      } else {\n        after = ''\n      }\n    } while (after !== '')\n\n    return pages.reduce((arr, page) => {\n      if (page && page.items && page.items.length > 0) {\n        return arr.concat(page.items)\n      }\n\n      return arr\n    }, [] as Array<T>)\n  }\n\n  async product(options: FetchProductParams): Promise<Product> {\n    const query = getProductByHandleQuery\n    const response = await this.request<GraphQLPageResponse<ProductOptions>>(\n      query,\n      'getProductByHandle',\n      {\n        handle: options.handle,\n        locale: options.locale || 'en-us',\n      }\n    )\n\n    if (response.success && response.data) {\n      return createProduct(response.data as ProductOptions)\n    }\n\n    throw new Error(response.error)\n  }\n\n  async products(options: FetchProductsParams): Promise<Product[]> {\n    const { handles, locale } = options\n    const useLocale = locale || this.locale\n\n    const requests = handles.map((handle) => {\n      return this.product({\n        handle,\n        locale: useLocale,\n      }).catch(() => {\n        return undefined\n      })\n    })\n\n    const responses = await Promise.all(requests)\n\n    const successes = responses.reduce((arr, response) => {\n      if (response) {\n        arr.push(response)\n      }\n\n      return arr\n    }, [] as Product[])\n\n    return successes\n  }\n\n  async collection(options: FetchCollectionParams): Promise<Collection> {\n    const query = getCollectionByHandleQuery\n    const response = await this.request<\n      GraphQLPageResponse<CreateCollectionOptions>\n    >(query, 'getCollectionByHandle', {\n      handle: options.handle,\n      locale: options.locale || 'en-us',\n    })\n\n    if (response.success && response.data) {\n      return createCollection(response.data as CreateCollectionOptions)\n    }\n\n    throw new Error(response.error)\n  }\n\n  async collectionPage(options: FetchCollectionPageParams): Promise<Product[]> {\n    const { handle, locale, list, paginate, index, itemsPerPage } = options\n    let { collection } = options\n\n    if (typeof collection === 'undefined') {\n      if (handle && handle.length > 0) {\n        collection = await this.collection({\n          handle,\n          locale,\n        })\n      } else {\n        throw new Error('A collection or handle is required')\n      }\n    }\n\n    const handles = getListHandles(collection.productLists, {\n      selectedList: list,\n      paginate: typeof paginate !== 'undefined' ? paginate : false,\n      index,\n      itemsPerPage,\n    })\n\n    return this.products({\n      handles,\n      locale,\n    })\n  }\n\n  async content({\n    handle,\n    type = 'page',\n    locale,\n    blogHandle = 'blog',\n  }: FetchContentParams): Promise<Content> {\n    const useLocale = locale || this.locale\n    const query = getContentByHandleQuery\n    const response = await this.request<\n      GraphQLPageResponse<CreateContentOptions>\n    >(query, 'getContentByHandle', {\n      type,\n      handle,\n      locale: useLocale,\n      blogHandle,\n    })\n\n    if (response.success && response.data) {\n      return createContent(response.data as CreateContentOptions)\n    }\n\n    throw new Error(response.error)\n  }\n\n  page(options: FetchPageParams): Promise<Content> {\n    return this.content({\n      handle: options.handle,\n      type: 'page',\n      locale: options.locale,\n    })\n  }\n\n  async pages(options: FetchPagesParams): Promise<Content[]> {\n    const { handles, locale } = options\n    const useLocale = locale || this.locale\n\n    const requests = handles.map((handle) => {\n      return this.content({\n        type: 'page',\n        handle,\n        locale: useLocale,\n      }).catch(() => {\n        return undefined\n      })\n    })\n\n    const responses = await Promise.all(requests)\n\n    const successes = responses.reduce((arr, response) => {\n      if (response) {\n        arr.push(response)\n      }\n\n      return arr\n    }, [] as Content[])\n\n    return successes\n  }\n\n  blog(options: FetchBlogParams): Promise<Content> {\n    return this.content({\n      handle: options.handle,\n      type: 'blog',\n      locale: options.locale,\n    })\n  }\n\n  article(options: FetchArticleParams): Promise<Content> {\n    return this.content({\n      handle: options.handle,\n      type: 'article',\n      locale: options.locale,\n      blogHandle: options.blogHandle || 'blog',\n    })\n  }\n\n  async articles(options: FetchArticlesParams): Promise<Content[]> {\n    const { handles, locale, blogHandle } = options\n    const useLocale = locale || this.locale\n\n    const requests = handles.map((handle) => {\n      return this.article({\n        handle,\n        blogHandle,\n        locale: useLocale,\n      }).catch(() => {\n        return undefined\n      })\n    })\n\n    const responses = await Promise.all(requests)\n\n    const successes = responses.reduce((arr, response) => {\n      if (response) {\n        arr.push(response)\n      }\n\n      return arr\n    }, [] as Content[])\n\n    return successes\n  }\n\n  async blogPage(options: FetchBlogPageParams): Promise<Content[]> {\n    const { handle, locale, list, paginate, index, itemsPerPage } = options\n    let { blog } = options\n\n    if (typeof blog === 'undefined') {\n      if (handle && handle.length > 0) {\n        blog = await this.blog({\n          handle,\n          locale,\n        })\n      } else {\n        throw new Error('A blog or handle is required')\n      }\n    }\n\n    if (blog.articleLists) {\n      const handles = getListHandles(blog.articleLists, {\n        selectedList: list,\n        paginate: typeof paginate !== 'undefined' ? paginate : false,\n        index,\n        itemsPerPage,\n      })\n\n      return this.articles({\n        handles,\n        locale,\n        blogHandle: handle || blog.handle,\n      })\n    }\n\n    return []\n  }\n\n  async allProducts(params?: { limit?: number }): Promise<Product[]> {\n    const query = getProductsQuery\n    const products = await this.getAllPageItems<ProductOptions>({\n      query,\n      queryName: 'getProducts',\n      first: params && params.limit ? params.limit : 2000,\n    })\n\n    return products.map((product) => createProduct(product))\n  }\n\n  async allCollections(params?: { limit?: number }): Promise<Collection[]> {\n    const query = getCollectionsQuery\n    const collections = await this.getAllPageItems<CreateCollectionOptions>({\n      query,\n      queryName: 'getCollections',\n      first: params && params.limit ? params.limit : 2000,\n    })\n\n    return collections.map((collection) => createCollection(collection))\n  }\n\n  async allContent(params?: { limit?: number }): Promise<Content[]> {\n    const query = getContentQuery\n    const content = await this.getAllPageItems<CreateContentOptions>({\n      query,\n      queryName: 'getContent',\n      first: params && params.limit ? params.limit : 2000,\n    })\n\n    return content.map((entry) => createContent(entry))\n  }\n\n  async space(): Promise<Space> {\n    const query = getSpaceQuery\n    const response = await this.request<CreateSpaceOptions>(query, 'getSpace')\n\n    if (response) {\n      if (response.success && response.data) {\n        return createSpace(response.data)\n      }\n\n      if (response && !response.success && response.error) {\n        throw new Error(response.error)\n      }\n    }\n\n    throw new Error('Invalid response attempting getSpace query')\n  }\n\n  async processCheckout(params: ProcessCheckoutParams): Promise<Checkout> {\n    const query = processCheckoutMutation\n    const response = await this.request<Checkout>(query, 'processCheckout', {\n      input: {\n        ...params,\n      },\n    })\n\n    if (response) {\n      if (response.success && response.data) {\n        return response.data\n      }\n\n      if (response && !response.success && response.error) {\n        throw new Error(response.error)\n      }\n    }\n\n    throw new Error('Invalid response attempting processCheckout mutation')\n  }\n\n  async queryCheckout(params: { id: string; url: string }): Promise<Checkout> {\n    const query = getCheckoutQuery\n    const response = await this.request<Checkout>(query, 'getCheckout', {\n      ...params,\n    })\n\n    if (response) {\n      if (response.success && response.data) {\n        return response.data\n      }\n\n      if (response && !response.success && response.error) {\n        throw new Error(response.error)\n      }\n    }\n\n    throw new Error('Invalid response attempting getCheckout query')\n  }\n\n  async isVariantAvailable(params: {\n    productId: string\n    variantId: string\n  }): Promise<boolean> {\n    const query = getVariantAvailabilityQuery\n    const response = await this.request<boolean>(\n      query,\n      'getVariantAvailability',\n      {\n        ...params,\n      }\n    )\n\n    if (response) {\n      if (\n        response.success &&\n        typeof response.data !== 'undefined' &&\n        response.data !== null\n      ) {\n        return response.data\n      }\n\n      if (response && !response.success && response.error) {\n        throw new Error(response.error)\n      }\n    }\n\n    throw new Error('Invalid response attempting getVariantAvailability query')\n  }\n}\n","import NacelleGraphQLConnector, {\n  ProcessCheckoutParams,\n} from '../connectors/graphql/nacelleGraphQLConnector'\nimport { Checkout } from '../objects/checkout'\n\ninterface NacelleCheckoutParams {\n  connector?: NacelleGraphQLConnector\n  endpoint?: string\n  spaceId?: string\n  token?: string\n}\n\nexport default class NacelleCheckout {\n  connector: NacelleGraphQLConnector\n\n  constructor(params: NacelleCheckoutParams) {\n    if (params.connector) {\n      this.connector = params.connector\n    } else if (params.endpoint && params.spaceId && params.token) {\n      this.connector = new NacelleGraphQLConnector({\n        endpoint: params.endpoint,\n        spaceId: params.spaceId,\n        token: params.token,\n      })\n    } else {\n      throw new Error('Missing parameters to initialize checkout module')\n    }\n  }\n\n  process(params: ProcessCheckoutParams): Promise<Checkout> {\n    return this.connector.processCheckout(params)\n  }\n\n  get(params: { id: string; url: string }): Promise<Checkout> {\n    if (typeof params.id === 'undefined' || params.id.length === 0) {\n      throw new Error(\n        'Missing parameter \"id\". Querying for a checkout requires a checkout Id.'\n      )\n    }\n\n    if (typeof params.url === 'undefined' || params.url.length === 0) {\n      throw new Error(\n        'Missing parameter \"url\". Querying for a checkout requires a checkout url.'\n      )\n    }\n\n    return this.connector.queryCheckout(params)\n  }\n}\n","import NacelleGraphQLConnector from '../connectors/graphql/nacelleGraphQLConnector'\n\ninterface NacelleStatusParams {\n  connector?: NacelleGraphQLConnector\n  endpoint?: string\n  spaceId?: string\n  token?: string\n}\n\nexport default class NacelleStatus {\n  connector: NacelleGraphQLConnector\n\n  constructor(params: NacelleStatusParams) {\n    if (params.connector) {\n      this.connector = params.connector\n    } else if (params.endpoint && params.spaceId && params.token) {\n      this.connector = new NacelleGraphQLConnector({\n        endpoint: params.endpoint,\n        spaceId: params.spaceId,\n        token: params.token,\n      })\n    } else {\n      throw new Error('Missing parameters to initialize checkout module')\n    }\n  }\n\n  isVariantAvailable(params: {\n    productId: string\n    variantId: string\n  }): Promise<boolean> {\n    return this.connector.isVariantAvailable(params)\n  }\n}\n","export default `\n  query getWishlistsByCustomerSourceId ($customerId: String!, $first: Int, $nextToken: String) {\n    getWishlistsByCustomerSourceId (customerId: $customerId, first: $first, nextToken: $nextToken) {\n      items {\n        id,\n        customerSourceId,\n        title\n        \n        items {\n          variantId\n          handle\n        }\n      }\n      nextToken\n    }\n  }\n`\n","export default `\n  mutation putWishlist ($input: WishlistInput!) {\n    putWishlist (input: $input) {\n      id,\n      customerSourceId,\n      items {\n        variantId\n        handle\n      }\n    }\n  }\n`\n","import HttpClient from '../util/http/HttpClient'\nimport HttpClientAxios from '../util/http/HttpClientAxios'\nimport { WishlistAxiosOptions } from '../objects/wishlist'\nimport {\n  GetWishlistParams,\n  PutWishlistParams,\n} from '../connectors/interfaces/parameters'\nimport getWishlistsByCustomerSourceIdQuery from '../connectors/graphql/queries/getWishlistsByCustomerSourceIdQuery'\nimport putWishlistMutation from '../connectors/graphql/mutations/putWishlistMutation'\n\nexport interface NacelleWishlistParams {\n  endpoint?: string\n  httpClient?: HttpClient\n  spaceId: string\n  token: string\n}\n\nexport default class NacelleWishlist {\n  endpoint: string\n  apiClient: HttpClient\n\n  constructor(params: NacelleWishlistParams) {\n    if (params && params.endpoint && params.endpoint.length > 0) {\n      this.endpoint = params.endpoint\n    } else if (\n      process &&\n      process.env &&\n      process.env.NACELLE_WISHLIST_ENDPOINT &&\n      process.env.NACELLE_WISHLIST_ENDPOINT.length > 0\n    ) {\n      this.endpoint = process.env.NACELLE_WISHLIST_ENDPOINT\n    } else {\n      // Set default Wishlist endpoint\n      this.endpoint = 'https://wishlist.hailfrequency.com/graphql'\n    }\n\n    const axiosOptions: WishlistAxiosOptions = {\n      headers: {\n        'Content-Type': 'application/json',\n        'X-Nacelle-Space-Id': params.spaceId,\n        'X-Nacelle-Space-Token': params.token,\n      },\n    }\n\n    this.apiClient =\n      params && params.httpClient\n        ? params.httpClient\n        : new HttpClientAxios(axiosOptions)\n  }\n\n  put(params: PutWishlistParams): Promise<any> {\n    return this.apiClient.post(this.endpoint, {\n      query: putWishlistMutation,\n      variables: { input: { ...params } },\n    })\n  }\n\n  get(params: GetWishlistParams): Promise<any> {\n    return this.apiClient.post(this.endpoint, {\n      query: getWishlistsByCustomerSourceIdQuery,\n      variables: params,\n    })\n  }\n}\n","import HttpClient from '../util/http/HttpClient'\nimport HttpClientAxios from '../util/http/HttpClientAxios'\n\nexport interface NacelleEventsParams {\n  endpoint?: string\n  httpClient?: HttpClient\n  disable?: boolean\n}\n\nexport interface EventSubscription {\n  eventType: string\n  callback: (event: EventObject) => EventObject | null\n}\n\nexport interface EventInput {\n  eventType: EventType | string\n  spaceId: string\n  url?: string\n  metafields?: string[]\n  value?: MonetaryValue\n  cart?: CartItem[]\n  user?: User\n  [key: string]: any\n}\n\nexport interface EventUrl {\n  url?: string\n  domain: string\n  route: string\n  urlParams?: string[]\n}\n\nexport interface GlobalEventData {\n  sessionEventCount?: number\n  attributionType?: EventType | string\n  attributionData?: Record<string, unknown>\n}\n\nexport interface EventObject extends EventInput, EventUrl, GlobalEventData {}\n\nexport interface CartItem {\n  productId: string\n  variantHandle: string\n  value: MonetaryValue\n}\n\n/**\n * Monetary value of an event\n * @property {number} amount - Amount in cents. Example: 3599 to represent $35.99\n * @property {string} currency - Currency string. Example: 'USD'\n */\nexport interface MonetaryValue {\n  amount: number\n  currency: string\n}\n\nexport interface User {\n  id?: string\n  anonymousId?: string\n  device?: string\n  ip?: string\n  email?: string\n  phone?: string\n}\n\nexport enum EventType {\n  productView = 'productView',\n  search = 'search',\n  productRecommendation = 'productRecommendation',\n  pageView = 'pageView',\n  collectionView = 'collectionView',\n  blogView = 'blogView',\n  articleView = 'articleView',\n  cartAdd = 'cartAdd',\n  cartRemove = 'cartRemove',\n  checkoutInit = 'checkoutInit',\n  checkoutComplete = 'checkoutComplete',\n}\n\nexport default class NacelleEvents {\n  endpoint: string\n  apiClient: HttpClient\n  disable: boolean\n  subscriptions: EventSubscription[]\n  attributionEvents: {\n    [key: string]: (attributionEvent: EventObject) => Record<string, unknown>\n  }\n\n  constructor(params?: NacelleEventsParams) {\n    if (params && params.endpoint && params.endpoint.length > 0) {\n      this.endpoint = params.endpoint\n    } else if (\n      process &&\n      process.env &&\n      process.env.NACELLE_TEM_ENDPOINT &&\n      process.env.NACELLE_TEM_ENDPOINT.length > 0\n    ) {\n      this.endpoint = process.env.NACELLE_TEM_ENDPOINT\n    } else {\n      // Set default TEM endpoint\n      this.endpoint = 'https://tem.hailfrequency.com/events/add'\n    }\n\n    this.apiClient =\n      params && params.httpClient ? params.httpClient : new HttpClientAxios()\n\n    if (params && typeof params.disable !== 'undefined') {\n      this.disable = params.disable\n    } else {\n      this.disable = false\n    }\n\n    this.subscriptions = []\n    this.attributionEvents = {}\n  }\n\n  log(eventInput: EventInput): void {\n    if (this.disable) {\n      return\n    }\n\n    updateSessionEventCount()\n\n    const event: EventObject = {\n      ...eventInput,\n      user: {\n        device: getDevice(),\n        ...eventInput.user,\n      },\n      ...getUrlParts(eventInput.url),\n      ...getGlobalEventData(),\n    }\n\n    const getAttributionData = this.attributionEvents[event.eventType]\n    if (getAttributionData) {\n      setGlobalEventData({\n        attributionType: event.eventType,\n        attributionData: getAttributionData(event),\n      })\n    }\n\n    const modifiedEvent = this.subscriptions\n      .filter(\n        ({ eventType }) => event.eventType === eventType || eventType === '*'\n      )\n      .filter(({ callback }) => !!callback)\n      .map(({ callback }) => callback(event))\n      .reduce((acc, cur) => ({ ...acc, ...cur }), {})\n\n    const eventToSend: EventObject = {\n      ...event,\n      ...modifiedEvent,\n    }\n\n    this.apiClient.post(this.endpoint, eventToSend)\n  }\n\n  onAttributionEvent(\n    eventType: string,\n    getAttributionData: (event: EventObject) => Record<string, unknown>\n  ): void {\n    this.attributionEvents[eventType] = getAttributionData\n  }\n\n  onEvent(\n    eventType: string,\n    callback: (event: EventObject) => EventObject\n  ): void {\n    this.subscriptions.push({\n      eventType,\n      callback,\n    })\n  }\n}\n\nconst getDevice = (): string => {\n  const globalScope = getGlobalScope()\n  const device =\n    globalScope && globalScope.navigator && globalScope.navigator.userAgent\n      ? globalScope.navigator.userAgent.toLowerCase()\n      : 'unknown'\n  return device\n}\n\nconst getUrlParts = (url: string | undefined): EventUrl => {\n  const globalScope = getGlobalScope()\n  const href = globalScope && globalScope.location && globalScope.location.href\n  const parsedUrl = tryCatch(\n    () => new URL(url || ''),\n    () =>\n      tryCatch(\n        () => new URL(href || ''),\n        () => undefined\n      )\n  ) as URL | undefined\n  const urlParams = parsedUrl\n    ? parsedUrl.search\n        .replace(/^\\?/g, '')\n        .split('&')\n        .filter((x) => !!x && x.length)\n    : []\n\n  return {\n    url: parsedUrl ? parsedUrl.toString() : '',\n    domain: parsedUrl ? parsedUrl.hostname : '',\n    route: parsedUrl ? parsedUrl.pathname : '',\n    urlParams,\n  }\n}\n\nconst getGlobalScope = (): {\n  nacelleEventData?: GlobalEventData\n  navigator?: { userAgent: string }\n  location?: { href: string }\n} => {\n  const globalScope = tryCatch(\n    // eslint-disable-next-line no-undef\n    () => globalThis,\n    () =>\n      tryCatch(\n        () => window,\n        () =>\n          tryCatch(\n            () => global,\n            () => undefined\n          )\n      )\n  ) as {\n    nacelleEventData?: GlobalEventData\n  }\n\n  return globalScope\n}\n\nconst getGlobalEventData = (): GlobalEventData => {\n  const globalScope = getGlobalScope()\n  const eventData = (globalScope && globalScope.nacelleEventData) || {}\n  return eventData\n}\n\nconst setGlobalEventData = (data: GlobalEventData): void => {\n  const globalScope = getGlobalScope()\n  if (!globalScope) {\n    return\n  }\n\n  globalScope.nacelleEventData = {\n    ...globalScope.nacelleEventData,\n    ...data,\n  }\n}\n\nconst updateSessionEventCount = () => {\n  const globalEventData = getGlobalEventData()\n  setGlobalEventData({\n    sessionEventCount: (globalEventData.sessionEventCount || 0) + 1,\n  })\n}\n\nconst tryCatch = (tryFunc: Function, catchFunc: Function): any => {\n  try {\n    return tryFunc()\n  } catch (error) {\n    return catchFunc(error)\n  }\n}\n","export default (prefix: string, parentHandle?: string) => {\n  if (parentHandle === undefined || parentHandle === null) {\n    parentHandle = ''\n  } else {\n    parentHandle = `${parentHandle}/`\n  }\n\n  switch (prefix) {\n    case 'collection':\n      return `data/collections/${parentHandle}`\n    case 'page':\n      return `data/pages/${parentHandle}`\n    case 'product':\n      return `data/products/${parentHandle}`\n    case 'shop':\n      return `data/shop/${parentHandle}`\n    case 'article':\n      return `data/articles/${parentHandle}`\n    case 'blog':\n      return `data/blogs/${parentHandle}`\n    default:\n      return `data/content/${parentHandle}`\n  }\n}\n","import constructDataPathPrefix from './constructDataPathPrefix'\n\ninterface PathParams {\n  type: string\n  handle: string\n  locale: string\n  parentHandle?: string\n}\n\nconst defaultTypes = [\n  'product',\n  'collection',\n  'page',\n  'blog',\n  'article',\n  'content',\n]\n\nconst DELIMITER = '--'\n\nexport default (params: PathParams): string => {\n  const formattedLocal = params.locale.toLowerCase().replace('_', '-')\n  let path = `${params.handle}${DELIMITER}${formattedLocal}`\n\n  if (defaultTypes.indexOf(params.type) === -1) {\n    path = `${path}${DELIMITER}${params.type}`\n  }\n\n  const prefix = constructDataPathPrefix(params.type, params.parentHandle)\n\n  return `${prefix}${path}/static.json`\n}\n","import { NacelleConnector, NacelleConnectorParams } from '../nacelleConnector'\nimport {\n  FetchProductParams,\n  FetchProductsParams,\n  FetchCollectionParams,\n  FetchCollectionPageParams,\n  FetchContentParams,\n  FetchPageParams,\n  FetchPagesParams,\n  FetchBlogParams,\n  FetchArticleParams,\n  FetchArticlesParams,\n  FetchBlogPageParams,\n} from '../interfaces/parameters'\nimport { Product, ProductOptions, createProduct } from '../../objects/product'\nimport {\n  createCollection,\n  Collection,\n  CreateCollectionOptions,\n} from '../../objects/collection'\nimport {\n  createContent,\n  Content,\n  CreateContentOptions,\n} from '../../objects/content'\nimport constructDataPath from './utils/constructDataPath'\nimport getListHandles from './utils/getListHandles'\nimport { Space, CreateSpaceOptions, createSpace } from '../../objects/space'\n\nexport interface NacelleStaticConnectorParams extends NacelleConnectorParams {\n  basePath?: string\n}\n\nexport interface NacellStaticRequestResponse<T> {\n  success: boolean\n  data: T | null\n  error?: string\n}\n\nexport interface SearchStaticResponse {\n  products: Product[]\n  [key: string]: any\n}\n\ninterface OnErrorParams {\n  method: string\n  params: any\n  error: Error\n}\n\ninterface OnError {\n  <T>(options: OnErrorParams): Promise<T> | T\n}\n\nexport default class NacelleStaticConnector extends NacelleConnector {\n  basePath: string\n  onError?: OnError\n\n  constructor(params?: NacelleStaticConnectorParams) {\n    super(params)\n\n    this.basePath = params && params.basePath ? params.basePath : '/'\n  }\n\n  async request<T>(path: string): Promise<NacellStaticRequestResponse<T>> {\n    const url = `${this.basePath}${path}`\n\n    try {\n      const response = await this.apiClient.get<T>(url)\n\n      if (\n        response &&\n        response.data &&\n        response.headers &&\n        response.headers['content-type'].includes('application/json')\n      ) {\n        return {\n          success: true,\n          data: response.data,\n        }\n      }\n\n      throw new Error(`Unable to find static resource at ${url}`)\n    } catch (error) {\n      return {\n        success: false,\n        error: error.message,\n        data: null,\n      }\n    }\n  }\n\n  async requestMany<T>(paths: string[]): Promise<T[]> {\n    const requests = paths.map((path) => {\n      return this.request<T>(path)\n    })\n    const responses = await Promise.all(requests)\n    const successes = responses.reduce((arr, response) => {\n      if (response.success && response.data) {\n        arr.push(response.data)\n      }\n\n      return arr\n    }, [] as T[])\n\n    return successes\n  }\n\n  async product(options: FetchProductParams): Promise<Product> {\n    try {\n      const { handle, locale } = options\n      const useLocale = locale || this.locale\n      const path = constructDataPath({\n        type: 'product',\n        handle: handle,\n        locale: useLocale,\n      })\n      const response = await this.request<ProductOptions>(path)\n\n      if (response.success && response.data) {\n        return createProduct(response.data)\n      }\n\n      throw new Error(response.error)\n    } catch (error) {\n      if (this.onError) {\n        return this.onError<Product>({\n          method: 'product',\n          params: options,\n          error,\n        })\n      }\n      throw error\n    }\n  }\n\n  async products(options: FetchProductsParams): Promise<Product[]> {\n    const { handles, locale } = options\n    const useLocale = locale || this.locale\n\n    const requests = handles.map((handle) => {\n      return this.product({\n        handle,\n        locale: useLocale,\n      }).catch(() => {\n        return undefined\n      })\n    })\n\n    const responses = await Promise.all(requests)\n\n    const successes = responses.reduce((arr, response) => {\n      if (response) {\n        arr.push(response)\n      }\n\n      return arr\n    }, [] as Product[])\n\n    return successes\n  }\n\n  async collection(options: FetchCollectionParams): Promise<Collection> {\n    try {\n      const { handle, locale } = options\n      const useLocale = locale || this.locale\n      const path = constructDataPath({\n        type: 'collection',\n        handle: handle,\n        locale: useLocale,\n      })\n      const response = await this.request<CreateCollectionOptions>(path)\n\n      if (response.success && response.data) {\n        return createCollection(response.data)\n      }\n\n      throw new Error(response.error)\n    } catch (error) {\n      if (this.onError) {\n        return this.onError<Collection>({\n          method: 'collection',\n          params: options,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async collectionPage(options: FetchCollectionPageParams): Promise<Product[]> {\n    try {\n      const { handle, locale, list, paginate, index, itemsPerPage } = options\n      let { collection } = options\n\n      if (typeof collection === 'undefined') {\n        if (handle && handle.length > 0) {\n          collection = await this.collection({\n            handle,\n            locale,\n          })\n        } else {\n          throw new Error('A collection or handle is required')\n        }\n      }\n\n      const handles = getListHandles(collection.productLists, {\n        selectedList: list,\n        paginate: typeof paginate !== 'undefined' ? paginate : false,\n        index,\n        itemsPerPage,\n      })\n\n      return this.products({\n        handles,\n        locale,\n      })\n    } catch (error) {\n      if (this.onError) {\n        return this.onError<Product[]>({\n          method: 'collectionPage',\n          params: options,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async content({\n    handle,\n    type = 'page',\n    locale,\n    blogHandle = 'blog',\n  }: FetchContentParams): Promise<Content> {\n    try {\n      const useLocale = locale || this.locale\n      let path = constructDataPath({\n        type,\n        handle: handle,\n        locale: useLocale,\n      })\n\n      if (type === 'article') {\n        path = constructDataPath({\n          type,\n          handle: handle,\n          locale: useLocale,\n          parentHandle: blogHandle,\n        })\n      }\n\n      const response = await this.request<CreateContentOptions>(path)\n\n      if (response.success && response.data) {\n        return createContent(response.data)\n      }\n\n      throw new Error(response.error)\n    } catch (error) {\n      if (this.onError) {\n        return this.onError<Content>({\n          method: 'content',\n          params: { handle, type, locale, blogHandle },\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  page(options: FetchPageParams): Promise<Content> {\n    return this.content({\n      handle: options.handle,\n      type: 'page',\n      locale: options.locale,\n    })\n  }\n\n  async pages(options: FetchPagesParams): Promise<Content[]> {\n    const { handles, locale } = options\n    const useLocale = locale || this.locale\n\n    const requests = handles.map((handle) => {\n      return this.content({\n        type: 'page',\n        handle,\n        locale: useLocale,\n      }).catch(() => {\n        return undefined\n      })\n    })\n\n    const responses = await Promise.all(requests)\n\n    const successes = responses.reduce((arr, response) => {\n      if (response) {\n        arr.push(response)\n      }\n\n      return arr\n    }, [] as Content[])\n\n    return successes\n  }\n\n  blog(options: FetchBlogParams): Promise<Content> {\n    return this.content({\n      handle: options.handle,\n      type: 'blog',\n      locale: options.locale,\n    })\n  }\n\n  article(options: FetchArticleParams): Promise<Content> {\n    return this.content({\n      handle: options.handle,\n      type: 'article',\n      locale: options.locale,\n      blogHandle: options.blogHandle || 'blog',\n    })\n  }\n\n  async articles(options: FetchArticlesParams): Promise<Content[]> {\n    const { handles, locale, blogHandle } = options\n    const useLocale = locale || this.locale\n\n    const requests = handles.map((handle) => {\n      return this.article({\n        handle,\n        blogHandle,\n        locale: useLocale,\n      }).catch(() => {\n        return undefined\n      })\n    })\n\n    const responses = await Promise.all(requests)\n\n    const successes = responses.reduce((arr, response) => {\n      if (response) {\n        arr.push(response)\n      }\n\n      return arr\n    }, [] as Content[])\n\n    return successes\n  }\n\n  async blogPage(options: FetchBlogPageParams): Promise<Content[]> {\n    try {\n      const { handle, locale, list, paginate, index, itemsPerPage } = options\n      let { blog } = options\n\n      if (typeof blog === 'undefined') {\n        if (handle && handle.length > 0) {\n          blog = await this.blog({\n            handle,\n            locale,\n          })\n        } else {\n          throw new Error('A blog or handle is required')\n        }\n      }\n\n      if (blog.articleLists) {\n        const handles = getListHandles(blog.articleLists, {\n          selectedList: list,\n          paginate: typeof paginate !== 'undefined' ? paginate : false,\n          index,\n          itemsPerPage,\n        })\n\n        return this.articles({\n          handles,\n          locale,\n          blogHandle: handle || blog.handle,\n        })\n      }\n\n      return []\n    } catch (error) {\n      if (this.onError) {\n        return this.onError<Content[]>({\n          method: 'blogPage',\n          params: options,\n          error,\n        })\n      }\n\n      throw error\n    }\n  }\n\n  async space(): Promise<Space> {\n    const path = 'data/space.json'\n    const response = await this.request<CreateSpaceOptions>(path)\n\n    if (response.success && response.data) {\n      return createSpace(response.data)\n    }\n\n    throw new Error(response.error)\n  }\n\n  async allProducts(): Promise<Product[]> {\n    const path = 'data/search.json'\n    const response = await this.request<SearchStaticResponse>(path)\n\n    if (response.success && response.data && response.data.products) {\n      return response.data.products.map((product) => createProduct(product))\n    }\n\n    if (response.error) {\n      throw new Error(response.error)\n    }\n\n    throw new Error('Unable to get all products from search.json static file.')\n  }\n}\n","import NacelleData from '../modules/data'\nimport NacelleCheckout from '../modules/checkout'\nimport NacelleStatus from '../modules/status'\nimport NacelleWishlist, { NacelleWishlistParams } from '../modules/wishlist'\nimport NacelleEvents, { NacelleEventsParams } from '../modules/events'\nimport { NacelleConnector } from '../connectors/nacelleConnector'\nimport NacelleStaticConnector from '../connectors/static/nacelleStaticConnector'\nimport NacelleGraphQLConnector from '../connectors/graphql/nacelleGraphQLConnector'\n\nexport interface NacelleClientParams {\n  token: string\n  id: string\n  nacelleEndpoint: string\n  eventsEndpoint?: string\n  wishlistEndpoint?: string\n  staticBasePath?: string\n  locale?: string\n  useStatic?: boolean\n  debugMode?: boolean\n  disableEvents?: boolean\n}\nexport class NacelleClient {\n  // Settings\n  id: string\n  token: string\n  nacelleEndpoint: string\n  useStatic: boolean\n  debugMode: boolean\n  defaultLocale: string\n\n  // Modules\n  data: NacelleData\n  checkout: NacelleCheckout\n  events: NacelleEvents\n  status: NacelleStatus\n  wishlist: NacelleWishlist\n\n  constructor(params: NacelleClientParams) {\n    if (typeof params.token === 'undefined' || params.token.length === 0) {\n      throw new Error('Nacelle space token is required.')\n    }\n\n    if (typeof params.id === 'undefined' || params.id.length === 0) {\n      throw new Error('Nacelle space id is required.')\n    }\n\n    if (\n      typeof params.nacelleEndpoint === 'undefined' ||\n      params.nacelleEndpoint.length === 0\n    ) {\n      throw new Error('Nacelle endpoint is required')\n    }\n\n    // Set defaults\n    this.id = params.id\n    this.token = params.token\n    this.nacelleEndpoint = params.nacelleEndpoint\n    this.useStatic =\n      typeof params.useStatic !== 'undefined' ? params.useStatic : true\n    this.debugMode =\n      typeof params.debugMode !== 'undefined' ? params.debugMode : false\n    this.defaultLocale =\n      typeof params.locale !== 'undefined' ? params.locale : 'en-us'\n\n    // Set up connectors\n    let dataConnector = new NacelleConnector({\n      locale: this.defaultLocale,\n    })\n\n    const staticConnector = new NacelleStaticConnector({\n      basePath: params.staticBasePath,\n      locale: this.defaultLocale,\n    })\n\n    const graphQLConnector = new NacelleGraphQLConnector({\n      endpoint: this.nacelleEndpoint,\n      spaceId: this.id,\n      token: this.token,\n      locale: this.defaultLocale,\n    })\n\n    // Setup Data module\n    if (this.useStatic) {\n      dataConnector = staticConnector\n    } else {\n      dataConnector = graphQLConnector\n    }\n\n    this.data = new NacelleData({\n      connector: dataConnector,\n      locale: this.defaultLocale,\n    })\n\n    // Setup Checkout Module\n    this.checkout = new NacelleCheckout({\n      connector: graphQLConnector,\n    })\n\n    // Setup Status Module\n    this.status = new NacelleStatus({\n      connector: graphQLConnector,\n    })\n\n    // Setup Events Module\n    const eventParams: NacelleEventsParams = {}\n\n    if (params.eventsEndpoint) {\n      eventParams.endpoint = params.eventsEndpoint\n    }\n\n    if (params.disableEvents) {\n      eventParams.disable = params.disableEvents\n    }\n\n    this.events = new NacelleEvents(eventParams)\n\n    // Setup WishList module\n    const wishlistParams: NacelleWishlistParams = {\n      spaceId: this.id,\n      token: this.token,\n    }\n\n    if (params.wishlistEndpoint) {\n      wishlistParams.endpoint = params.wishlistEndpoint\n    }\n\n    this.wishlist = new NacelleWishlist(wishlistParams)\n  }\n}\n"],"names":["NacelleData","params","connector","locale","currencyCode","afterSubscriptions","onDataError","updateDefaults","update","product","applyAfter","error","method","products","collection","collectionPage","content","page","pages","article","articles","blog","blogPage","space","allProducts","allCollections","collections","allContent","after","callback","push","responseObj","response","subs","filter","sub","HttpClientAxios","options","client","axios","create","responseType","headers","timeout","maxContentLength","get","url","post","data","NacelleConnector","apiClient","httpClient","_options","Error","selectedList","lists","selected","find","slug","undefined","paginate","index","itemsPerPage","list","getList","handles","slice","createProduct","id","handle","globalHandle","pimSyncSourceDomain","title","description","priceRange","min","max","availableForSale","tags","media","metafields","variants","indexedAt","createMedia","type","src","thumbnailSrc","altText","createItemList","obj","createCollection","productLists","featuredMedia","rest","Array","isArray","map","tagFields","reduce","fields","tag","includes","split","key","value","mapContentSections","sections","cmsSyncSource","formattedSections","JSON","parse","section","fieldTags","createFieldsFromTags","createContent","articleLists","cmsSyncSourceDomain","cmsSyncSourceContentId","relatedArticles","createSpace","name","domain","linklists","mediaFragment","metafieldFragment","productFragment","collectionFragment","NacelleGraphQLConnector","endpoint","spaceId","token","request","query","queryName","variables","errors","length","firstError","pop","message","success","stringify","getAllPageItems","arr","items","concat","first","nextToken","getProductByHandleQuery","useLocale","requests","Promise","all","responses","successes","getCollectionByHandleQuery","getListHandles","blogHandle","getContentByHandleQuery","getProductsQuery","limit","getCollectionsQuery","getContentQuery","entry","getSpaceQuery","processCheckout","processCheckoutMutation","input","queryCheckout","getCheckoutQuery","isVariantAvailable","getVariantAvailabilityQuery","NacelleCheckout","process","NacelleStatus","NacelleWishlist","env","NACELLE_WISHLIST_ENDPOINT","axiosOptions","put","putWishlistMutation","getWishlistsByCustomerSourceIdQuery","EventType","NacelleEvents","NACELLE_TEM_ENDPOINT","disable","subscriptions","attributionEvents","log","eventInput","updateSessionEventCount","event","user","device","getDevice","getUrlParts","getGlobalEventData","getAttributionData","eventType","setGlobalEventData","attributionType","attributionData","modifiedEvent","acc","cur","eventToSend","onAttributionEvent","onEvent","globalScope","getGlobalScope","navigator","userAgent","toLowerCase","href","location","parsedUrl","tryCatch","URL","urlParams","search","replace","x","toString","hostname","route","pathname","globalThis","window","global","eventData","nacelleEventData","globalEventData","sessionEventCount","tryFunc","catchFunc","prefix","parentHandle","defaultTypes","DELIMITER","formattedLocal","path","indexOf","constructDataPathPrefix","NacelleStaticConnector","basePath","requestMany","paths","constructDataPath","onError","NacelleClient","nacelleEndpoint","useStatic","debugMode","defaultLocale","dataConnector","staticConnector","staticBasePath","graphQLConnector","checkout","status","eventParams","eventsEndpoint","disableEvents","events","wishlistParams","wishlistEndpoint","wishlist"],"mappings":"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"}